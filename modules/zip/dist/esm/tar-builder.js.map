{"version":3,"file":"tar-builder.js","names":["Tar","TAR_BUILDER_OPTIONS","recordsPerBlock","TARBuilder","properties","id","name","extensions","mimeTypes","builder","options","constructor","_defineProperty","tape","addFile","filename","buffer","append","Uint8Array","count","build","Response","save","arrayBuffer"],"sources":["../../src/tar-builder.ts"],"sourcesContent":["import Tar from './lib/tar/tar';\n\nconst TAR_BUILDER_OPTIONS = {\n  recordsPerBlock: 20\n};\n\ntype TarBuilderOptions = {\n  recordsPerBlock?: number;\n};\n\n/**\n * Build a tar file by adding files\n */\nexport default class TARBuilder {\n  static get properties() {\n    return {\n      id: 'tar',\n      name: 'TAR',\n      extensions: ['tar'],\n      mimeTypes: ['application/x-tar'],\n      builder: TARBuilder,\n      options: TAR_BUILDER_OPTIONS\n    };\n  }\n\n  options: TarBuilderOptions;\n  tape: Tar;\n  count: number = 0;\n\n  constructor(options?: Partial<TarBuilderOptions>) {\n    this.options = {...TAR_BUILDER_OPTIONS, ...options};\n    this.tape = new Tar(this.options.recordsPerBlock);\n  }\n  /** Adds a file to the archive. */\n  addFile(filename: string, buffer: ArrayBuffer) {\n    this.tape.append(filename, new Uint8Array(buffer));\n    this.count++;\n  }\n\n  async build(): Promise<ArrayBuffer> {\n    return new Response(this.tape.save()).arrayBuffer();\n  }\n}\n"],"mappings":";AAAA,OAAOA,GAAG,MAAM,eAAe;AAE/B,MAAMC,mBAAmB,GAAG;EAC1BC,eAAe,EAAE;AACnB,CAAC;AASD,eAAe,MAAMC,UAAU,CAAC;EAC9B,WAAWC,UAAUA,CAAA,EAAG;IACtB,OAAO;MACLC,EAAE,EAAE,KAAK;MACTC,IAAI,EAAE,KAAK;MACXC,UAAU,EAAE,CAAC,KAAK,CAAC;MACnBC,SAAS,EAAE,CAAC,mBAAmB,CAAC;MAChCC,OAAO,EAAEN,UAAU;MACnBO,OAAO,EAAET;IACX,CAAC;EACH;EAMAU,WAAWA,CAACD,OAAoC,EAAE;IAAAE,eAAA;IAAAA,eAAA;IAAAA,eAAA,gBAFlC,CAAC;IAGf,IAAI,CAACF,OAAO,GAAG;MAAC,GAAGT,mBAAmB;MAAE,GAAGS;IAAO,CAAC;IACnD,IAAI,CAACG,IAAI,GAAG,IAAIb,GAAG,CAAC,IAAI,CAACU,OAAO,CAACR,eAAe,CAAC;EACnD;EAEAY,OAAOA,CAACC,QAAgB,EAAEC,MAAmB,EAAE;IAC7C,IAAI,CAACH,IAAI,CAACI,MAAM,CAACF,QAAQ,EAAE,IAAIG,UAAU,CAACF,MAAM,CAAC,CAAC;IAClD,IAAI,CAACG,KAAK,EAAE;EACd;EAEA,MAAMC,KAAKA,CAAA,EAAyB;IAClC,OAAO,IAAIC,QAAQ,CAAC,IAAI,CAACR,IAAI,CAACS,IAAI,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;EACrD;AACF"}