{"version":3,"file":"tar-builder.js","names":["_tar","_interopRequireDefault","require","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty2","default","getOwnPropertyDescriptors","defineProperties","defineProperty","TAR_BUILDER_OPTIONS","recordsPerBlock","TARBuilder","options","_classCallCheck2","tape","Tar","_createClass2","value","addFile","filename","buffer","append","Uint8Array","count","_build","_asyncToGenerator2","_regenerator","mark","_callee","wrap","_callee$","_context","prev","next","abrupt","Response","save","arrayBuffer","stop","build","get","id","name","extensions","mimeTypes","builder","exports"],"sources":["../../src/tar-builder.ts"],"sourcesContent":["import Tar from './lib/tar/tar';\n\nconst TAR_BUILDER_OPTIONS = {\n  recordsPerBlock: 20\n};\n\ntype TarBuilderOptions = {\n  recordsPerBlock?: number;\n};\n\n/**\n * Build a tar file by adding files\n */\nexport default class TARBuilder {\n  static get properties() {\n    return {\n      id: 'tar',\n      name: 'TAR',\n      extensions: ['tar'],\n      mimeTypes: ['application/x-tar'],\n      builder: TARBuilder,\n      options: TAR_BUILDER_OPTIONS\n    };\n  }\n\n  options: TarBuilderOptions;\n  tape: Tar;\n  count: number = 0;\n\n  constructor(options?: Partial<TarBuilderOptions>) {\n    this.options = {...TAR_BUILDER_OPTIONS, ...options};\n    this.tape = new Tar(this.options.recordsPerBlock);\n  }\n  /** Adds a file to the archive. */\n  addFile(filename: string, buffer: ArrayBuffer) {\n    this.tape.append(filename, new Uint8Array(buffer));\n    this.count++;\n  }\n\n  async build(): Promise<ArrayBuffer> {\n    return new Response(this.tape.save()).arrayBuffer();\n  }\n}\n"],"mappings":"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"}