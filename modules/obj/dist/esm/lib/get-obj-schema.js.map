{"version":3,"file":"get-obj-schema.js","names":["getDataTypeFromArray","getOBJSchema","attributes","metadata","arguments","length","undefined","stringMetadata","key","JSON","stringify","fields","attributeName","attribute","field","getFieldFromAttribute","push","name","type","value","isSingleValue","size","listSize","children","nullable"],"sources":["../../../src/lib/get-obj-schema.ts"],"sourcesContent":["// loaders.gl, MIT license\n\nimport type {Schema, SchemaMetadata, Field, MeshAttribute} from '@loaders.gl/schema';\nimport {getDataTypeFromArray} from '@loaders.gl/schema';\n\n/** Get Mesh Schema */\nexport function getOBJSchema(\n  attributes: Record<string, MeshAttribute>,\n  metadata: Record<string, unknown> = {}\n): Schema {\n  const stringMetadata: SchemaMetadata = {};\n  for (const key in metadata) {\n    if (key !== 'value') {\n      stringMetadata[key] = JSON.stringify(metadata[key]);\n    }\n  }\n\n  const fields: Field[] = [];\n  for (const attributeName in attributes) {\n    const attribute = attributes[attributeName];\n    const field = getFieldFromAttribute(attributeName, attribute);\n    fields.push(field);\n  }\n\n  return {fields, metadata: stringMetadata};\n}\n\n/** Get a Field describing the column from an OBJ attribute */\nfunction getFieldFromAttribute(name: string, attribute: MeshAttribute): Field {\n  const metadata: Record<string, string> = {};\n  for (const key in attribute) {\n    if (key !== 'value') {\n      metadata[key] = JSON.stringify(attribute[key]);\n    }\n  }\n\n  let {type} = getDataTypeFromArray(attribute.value);\n  const isSingleValue = attribute.size === 1 || attribute.size === undefined;\n  if (!isSingleValue) {\n    type = {type: 'fixed-size-list', listSize: attribute.size, children: [{name: 'values', type}]};\n  }\n  return {name, type, nullable: false, metadata};\n}\n"],"mappings":"AAGA,SAAQA,oBAAoB,QAAO,oBAAoB;AAGvD,OAAO,SAASC,YAAYA,CAC1BC,UAAyC,EAEjC;EAAA,IADRC,QAAiC,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,CAAC,CAAC;EAEtC,MAAMG,cAA8B,GAAG,CAAC,CAAC;EACzC,KAAK,MAAMC,GAAG,IAAIL,QAAQ,EAAE;IAC1B,IAAIK,GAAG,KAAK,OAAO,EAAE;MACnBD,cAAc,CAACC,GAAG,CAAC,GAAGC,IAAI,CAACC,SAAS,CAACP,QAAQ,CAACK,GAAG,CAAC,CAAC;IACrD;EACF;EAEA,MAAMG,MAAe,GAAG,EAAE;EAC1B,KAAK,MAAMC,aAAa,IAAIV,UAAU,EAAE;IACtC,MAAMW,SAAS,GAAGX,UAAU,CAACU,aAAa,CAAC;IAC3C,MAAME,KAAK,GAAGC,qBAAqB,CAACH,aAAa,EAAEC,SAAS,CAAC;IAC7DF,MAAM,CAACK,IAAI,CAACF,KAAK,CAAC;EACpB;EAEA,OAAO;IAACH,MAAM;IAAER,QAAQ,EAAEI;EAAc,CAAC;AAC3C;AAGA,SAASQ,qBAAqBA,CAACE,IAAY,EAAEJ,SAAwB,EAAS;EAC5E,MAAMV,QAAgC,GAAG,CAAC,CAAC;EAC3C,KAAK,MAAMK,GAAG,IAAIK,SAAS,EAAE;IAC3B,IAAIL,GAAG,KAAK,OAAO,EAAE;MACnBL,QAAQ,CAACK,GAAG,CAAC,GAAGC,IAAI,CAACC,SAAS,CAACG,SAAS,CAACL,GAAG,CAAC,CAAC;IAChD;EACF;EAEA,IAAI;IAACU;EAAI,CAAC,GAAGlB,oBAAoB,CAACa,SAAS,CAACM,KAAK,CAAC;EAClD,MAAMC,aAAa,GAAGP,SAAS,CAACQ,IAAI,KAAK,CAAC,IAAIR,SAAS,CAACQ,IAAI,KAAKf,SAAS;EAC1E,IAAI,CAACc,aAAa,EAAE;IAClBF,IAAI,GAAG;MAACA,IAAI,EAAE,iBAAiB;MAAEI,QAAQ,EAAET,SAAS,CAACQ,IAAI;MAAEE,QAAQ,EAAE,CAAC;QAACN,IAAI,EAAE,QAAQ;QAAEC;MAAI,CAAC;IAAC,CAAC;EAChG;EACA,OAAO;IAACD,IAAI;IAAEC,IAAI;IAAEM,QAAQ,EAAE,KAAK;IAAErB;EAAQ,CAAC;AAChD"}