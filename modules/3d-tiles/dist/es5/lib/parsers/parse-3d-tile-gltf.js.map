{"version":3,"file":"parse-3d-tile-gltf.js","names":["_gltf","require","parseGltf3DTile","_x","_x2","_x3","_x4","_parseGltf3DTile","apply","arguments","_asyncToGenerator2","default","_regenerator","mark","_callee","tile","arrayBuffer","options","context","parse","gltfWithBuffers","wrap","_callee$","_context","prev","next","rotateYtoZ","gltfUpAxis","assetGltfUpAxis","GLTFLoader","sent","gltf","postProcessGLTF","gpuMemoryUsageInBytes","_getMemoryUsageGLTF","stop"],"sources":["../../../../src/lib/parsers/parse-3d-tile-gltf.ts"],"sourcesContent":["import type {LoaderContext} from '@loaders.gl/loader-utils';\nimport type {Tiles3DLoaderOptions} from '../../tiles-3d-loader';\nimport {_getMemoryUsageGLTF, GLTFLoader, postProcessGLTF} from '@loaders.gl/gltf';\n\nexport async function parseGltf3DTile(\n  tile,\n  arrayBuffer: ArrayBuffer,\n  options: Tiles3DLoaderOptions,\n  context: LoaderContext\n): Promise<void> {\n  // Set flags\n  // glTF models need to be rotated from Y to Z up\n  // https://github.com/AnalyticalGraphicsInc/3d-tiles/tree/master/specification#y-up-to-z-up\n  tile.rotateYtoZ = true;\n  // Save gltf up axis\n  tile.gltfUpAxis =\n    options['3d-tiles'] && options['3d-tiles'].assetGltfUpAxis\n      ? options['3d-tiles'].assetGltfUpAxis\n      : 'Y';\n\n  const {parse} = context;\n  const gltfWithBuffers = await parse(arrayBuffer, GLTFLoader, options, context);\n  tile.gltf = postProcessGLTF(gltfWithBuffers);\n  tile.gpuMemoryUsageInBytes = _getMemoryUsageGLTF(tile.gltf);\n}\n"],"mappings":";;;;;;;;;AAEA,IAAAA,KAAA,GAAAC,OAAA;AAAkF,SAE5DC,eAAeA,CAAAC,EAAA,EAAAC,GAAA,EAAAC,GAAA,EAAAC,GAAA;EAAA,OAAAC,gBAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA;AAAA,SAAAF,iBAAA;EAAAA,gBAAA,OAAAG,kBAAA,CAAAC,OAAA,EAAAC,YAAA,CAAAD,OAAA,CAAAE,IAAA,CAA9B,SAAAC,QACLC,IAAI,EACJC,WAAwB,EACxBC,OAA6B,EAC7BC,OAAsB;IAAA,IAAAC,KAAA,EAAAC,eAAA;IAAA,OAAAR,YAAA,CAAAD,OAAA,CAAAU,IAAA,UAAAC,SAAAC,QAAA;MAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;QAAA;UAKtBV,IAAI,CAACW,UAAU,GAAG,IAAI;UAEtBX,IAAI,CAACY,UAAU,GACbV,OAAO,CAAC,UAAU,CAAC,IAAIA,OAAO,CAAC,UAAU,CAAC,CAACW,eAAe,GACtDX,OAAO,CAAC,UAAU,CAAC,CAACW,eAAe,GACnC,GAAG;UAEFT,KAAK,GAAID,OAAO,CAAhBC,KAAK;UAAAI,QAAA,CAAAE,IAAA;UAAA,OACkBN,KAAK,CAACH,WAAW,EAAEa,gBAAU,EAAEZ,OAAO,EAAEC,OAAO,CAAC;QAAA;UAAxEE,eAAe,GAAAG,QAAA,CAAAO,IAAA;UACrBf,IAAI,CAACgB,IAAI,GAAG,IAAAC,qBAAe,EAACZ,eAAe,CAAC;UAC5CL,IAAI,CAACkB,qBAAqB,GAAG,IAAAC,yBAAmB,EAACnB,IAAI,CAACgB,IAAI,CAAC;QAAC;QAAA;UAAA,OAAAR,QAAA,CAAAY,IAAA;MAAA;IAAA,GAAArB,OAAA;EAAA,CAC7D;EAAA,OAAAP,gBAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA"}