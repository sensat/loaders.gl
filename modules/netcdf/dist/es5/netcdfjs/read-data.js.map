{"version":3,"file":"read-data.js","names":["_readType","require","readNonRecord","buffer","variable","type","str2num","size","num2bytes","data","Array","i","readType","readRecord","recordDimension","width","length","step","recordStep","currentOffset","offset","seek"],"sources":["../../../src/netcdfjs/read-data.ts"],"sourcesContent":["import type {IOBuffer} from '../iobuffer/iobuffer';\nimport type {NetCDFRecordDimension, NetCDFVariable} from './netcdf-types';\nimport {readType, str2num, num2bytes} from './read-type';\n\n// const STREAMING = 4294967295;\n\n/**\n * Read data for the given non-record variable\n * @param buffer - Buffer for the file data\n * @param variable - Variable metadata\n * @return Data of the element\n */\nexport function readNonRecord(\n  buffer: IOBuffer,\n  variable: NetCDFVariable\n): (string | number | number[] | Uint8Array)[] {\n  // variable type\n  const type = str2num(variable.type);\n\n  // size of the data\n  const size = variable.size / num2bytes(type);\n\n  // iterates over the data\n  const data = new Array(size);\n  for (let i = 0; i < size; i++) {\n    data[i] = readType(buffer, type, 1);\n  }\n\n  return data;\n}\n\n/**\n * Read data for the given record variable\n * @param buffer - Buffer for the file data\n * @param variable - Variable metadata\n * @param recordDimension - Record dimension metadata\n * @return - Data of the element\n */\nexport function readRecord(\n  buffer: IOBuffer,\n  variable: NetCDFVariable,\n  recordDimension: NetCDFRecordDimension\n): (string | number | number[] | Uint8Array)[] {\n  // variable type\n  const type = str2num(variable.type);\n  const width = variable.size ? variable.size / num2bytes(type) : 1;\n\n  // size of the data\n  // TODO streaming data\n  const size = recordDimension.length;\n\n  // iterates over the data\n  const data = new Array(size);\n  const step = recordDimension.recordStep;\n\n  for (let i = 0; i < size; i++) {\n    const currentOffset = buffer.offset;\n    data[i] = readType(buffer, type, width);\n    buffer.seek(currentOffset + step);\n  }\n\n  return data;\n}\n"],"mappings":";;;;;;;AAEA,IAAAA,SAAA,GAAAC,OAAA;AAUO,SAASC,aAAaA,CAC3BC,MAAgB,EAChBC,QAAwB,EACqB;EAE7C,IAAMC,IAAI,GAAG,IAAAC,iBAAO,EAACF,QAAQ,CAACC,IAAI,CAAC;EAGnC,IAAME,IAAI,GAAGH,QAAQ,CAACG,IAAI,GAAG,IAAAC,mBAAS,EAACH,IAAI,CAAC;EAG5C,IAAMI,IAAI,GAAG,IAAIC,KAAK,CAACH,IAAI,CAAC;EAC5B,KAAK,IAAII,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGJ,IAAI,EAAEI,CAAC,EAAE,EAAE;IAC7BF,IAAI,CAACE,CAAC,CAAC,GAAG,IAAAC,kBAAQ,EAACT,MAAM,EAAEE,IAAI,EAAE,CAAC,CAAC;EACrC;EAEA,OAAOI,IAAI;AACb;AASO,SAASI,UAAUA,CACxBV,MAAgB,EAChBC,QAAwB,EACxBU,eAAsC,EACO;EAE7C,IAAMT,IAAI,GAAG,IAAAC,iBAAO,EAACF,QAAQ,CAACC,IAAI,CAAC;EACnC,IAAMU,KAAK,GAAGX,QAAQ,CAACG,IAAI,GAAGH,QAAQ,CAACG,IAAI,GAAG,IAAAC,mBAAS,EAACH,IAAI,CAAC,GAAG,CAAC;EAIjE,IAAME,IAAI,GAAGO,eAAe,CAACE,MAAM;EAGnC,IAAMP,IAAI,GAAG,IAAIC,KAAK,CAACH,IAAI,CAAC;EAC5B,IAAMU,IAAI,GAAGH,eAAe,CAACI,UAAU;EAEvC,KAAK,IAAIP,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGJ,IAAI,EAAEI,CAAC,EAAE,EAAE;IAC7B,IAAMQ,aAAa,GAAGhB,MAAM,CAACiB,MAAM;IACnCX,IAAI,CAACE,CAAC,CAAC,GAAG,IAAAC,kBAAQ,EAACT,MAAM,EAAEE,IAAI,EAAEU,KAAK,CAAC;IACvCZ,MAAM,CAACkB,IAAI,CAACF,aAAa,GAAGF,IAAI,CAAC;EACnC;EAEA,OAAOR,IAAI;AACb"}