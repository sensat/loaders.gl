{"version":3,"file":"blob-stream.js","names":["_readableStream","require","_blobStreamController","_Symbol$asyncIterator","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf2","default","result","NewTarget","constructor","Reflect","construct","arguments","apply","_possibleConstructorReturn2","sham","Proxy","Boolean","prototype","valueOf","call","e","_asyncIterator","iterable","method","async","sync","retry","Symbol","asyncIterator","iterator","AsyncFromSyncIterator","TypeError","s","AsyncFromSyncIteratorContinuation","r","Object","Promise","reject","done","resolve","value","then","n","next","return","_return","ret","throw","_throw","thr","BlobStream","_ReadableStreamPolyfi","_inherits2","_super","chunks","_this2","_classCallCheck2","BlobStreamController","values","type","_defineProperty2","_assertThisInitialized2","_chunks","_createClass2","key","_options","_this","_wrapAsyncGenerator2","_regenerator","mark","_callee","reader","wrap","_callee$","_context","prev","getReader","delegateYield","_asyncGeneratorDelegate2","_awaitAsyncGenerator2","releaseLock","stop","ReadableStreamPolyfill","exports"],"sources":["../../../../src/node/file/blob-stream.ts"],"sourcesContent":["/**\n * Forked from @gozala's web-blob under MIT license\n * @see https://github.com/Gozala/web-blob\n */\nimport {ReadableStreamPolyfill} from './readable-stream';\nimport {BlobStreamController} from './blob-stream-controller';\n\n/**\n * Blob stream is a `ReadableStream` extension optimized to have minimal\n * overhead when consumed as `AsyncIterable<Uint8Array>`.\n * extends {ReadableStream<Uint8Array>}\n * implements {AsyncIterable<Uint8Array>}\n */\n// @ts-ignore\nexport class BlobStream<T> extends ReadableStreamPolyfill<T> {\n  private readonly _chunks: Uint8Array[];\n  /**\n   * @param chunks\n   */\n  constructor(chunks) {\n    // @ts-ignore\n    super(new BlobStreamController(chunks.values()), {type: 'bytes'});\n    /** @private */\n    this._chunks = chunks;\n  }\n\n  /**\n   * @property [_options.preventCancel]\n   */\n  // @ts-ignore\n  async *[Symbol.asyncIterator](_options?: {preventCancel?: boolean}): AsyncIterable<Uint8Array> {\n    const reader = this.getReader();\n    yield* this._chunks;\n    reader.releaseLock();\n  }\n}\n"],"mappings":"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"}