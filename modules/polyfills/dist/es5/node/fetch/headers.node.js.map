{"version":3,"file":"headers.node.js","names":["Symbol","iterator","Headers","headers","_this","_classCallCheck2","default","_defineProperty2","map","forEach","value","name","append","Array","isArray","header","Object","getOwnPropertyNames","_createClass2","key","normalizeName","normalizeValue","oldValue","concat","_delete","get","has","hasOwnProperty","set","visitor","thisArg","arguments","length","undefined","call","keys","items","push","iteratorFor","values","entries","_Symbol$iterator","_regenerator","mark","wrap","value$","_context","prev","next","delegateYield","stop","exports","String","test","TypeError","toLowerCase","shift","done"],"sources":["../../../../src/node/fetch/headers.node.ts"],"sourcesContent":["/**\n * Polyfill for Browser Headers\n * Based on https://github.com/github/fetch under MIT license\n */\nexport class Headers {\n  map: {};\n\n  constructor(headers) {\n    this.map = {};\n\n    if (headers instanceof Headers) {\n      headers.forEach((value, name) => this.append(name, value));\n    } else if (Array.isArray(headers)) {\n      headers.forEach((header) => this.append(header[0], header[1]));\n    } else if (headers) {\n      Object.getOwnPropertyNames(headers).forEach((name) => this.append(name, headers[name]));\n    }\n  }\n\n  append(name, value) {\n    name = normalizeName(name);\n    value = normalizeValue(value);\n    const oldValue = this.map[name];\n    this.map[name] = oldValue ? `${oldValue}, ${value}` : value;\n  }\n\n  delete(name) {\n    delete this.map[normalizeName(name)];\n  }\n\n  get(name) {\n    name = normalizeName(name);\n    return this.has(name) ? this.map[name] : null;\n  }\n\n  has(name) {\n    return this.map.hasOwnProperty(normalizeName(name));\n  }\n\n  set(name, value) {\n    this.map[normalizeName(name)] = normalizeValue(value);\n  }\n\n  forEach(visitor, thisArg = null) {\n    for (const name in this.map) {\n      if (this.map.hasOwnProperty(name)) {\n        if (thisArg) {\n          visitor.call(thisArg, this.map[name], name, this);\n        } else {\n          visitor(this.map[name], name, this);\n        }\n      }\n    }\n  }\n\n  keys() {\n    const items: any[] = [];\n    this.forEach(function (value, name) {\n      items.push(name);\n    });\n    return iteratorFor(items);\n  }\n\n  values() {\n    const items: any[] = [];\n    this.forEach(function (value) {\n      items.push(value);\n    });\n    return iteratorFor(items);\n  }\n\n  entries() {\n    const items: any[] = [];\n    this.forEach(function (value, name) {\n      items.push([name, value]);\n    });\n    return iteratorFor(items);\n  }\n\n  *[Symbol.iterator]() {\n    // @ts-ignore must have a '[Symbol.iterator]()' method that returns an iterator.\n    yield* this.entries();\n  }\n}\n\nfunction normalizeName(name) {\n  if (typeof name !== 'string') {\n    name = String(name);\n  }\n  if (/[^a-z0-9\\-#$%&'*+.^_`|~]/i.test(name) || name === '') {\n    throw new TypeError('Invalid character in header field name');\n  }\n  return name.toLowerCase();\n}\n\nfunction normalizeValue(value) {\n  if (typeof value !== 'string') {\n    value = String(value);\n  }\n  return value;\n}\n\n// Build a destructive iterator for the value list\nfunction iteratorFor(items) {\n  const iterator = {\n    next() {\n      const value = items.shift();\n      return {done: value === undefined, value};\n    }\n  };\n\n  iterator[Symbol.iterator] = function () {\n    return iterator;\n  };\n\n  return iterator;\n}\n"],"mappings":"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"}