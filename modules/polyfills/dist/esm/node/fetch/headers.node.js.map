{"version":3,"file":"headers.node.js","names":["Symbol","iterator","Headers","constructor","headers","_defineProperty","map","forEach","value","name","append","Array","isArray","header","Object","getOwnPropertyNames","normalizeName","normalizeValue","oldValue","concat","delete","get","has","hasOwnProperty","set","visitor","thisArg","arguments","length","undefined","call","keys","items","push","iteratorFor","values","entries","_Symbol$iterator","String","test","TypeError","toLowerCase","next","shift","done"],"sources":["../../../../src/node/fetch/headers.node.ts"],"sourcesContent":["/**\n * Polyfill for Browser Headers\n * Based on https://github.com/github/fetch under MIT license\n */\nexport class Headers {\n  map: {};\n\n  constructor(headers) {\n    this.map = {};\n\n    if (headers instanceof Headers) {\n      headers.forEach((value, name) => this.append(name, value));\n    } else if (Array.isArray(headers)) {\n      headers.forEach((header) => this.append(header[0], header[1]));\n    } else if (headers) {\n      Object.getOwnPropertyNames(headers).forEach((name) => this.append(name, headers[name]));\n    }\n  }\n\n  append(name, value) {\n    name = normalizeName(name);\n    value = normalizeValue(value);\n    const oldValue = this.map[name];\n    this.map[name] = oldValue ? `${oldValue}, ${value}` : value;\n  }\n\n  delete(name) {\n    delete this.map[normalizeName(name)];\n  }\n\n  get(name) {\n    name = normalizeName(name);\n    return this.has(name) ? this.map[name] : null;\n  }\n\n  has(name) {\n    return this.map.hasOwnProperty(normalizeName(name));\n  }\n\n  set(name, value) {\n    this.map[normalizeName(name)] = normalizeValue(value);\n  }\n\n  forEach(visitor, thisArg = null) {\n    for (const name in this.map) {\n      if (this.map.hasOwnProperty(name)) {\n        if (thisArg) {\n          visitor.call(thisArg, this.map[name], name, this);\n        } else {\n          visitor(this.map[name], name, this);\n        }\n      }\n    }\n  }\n\n  keys() {\n    const items: any[] = [];\n    this.forEach(function (value, name) {\n      items.push(name);\n    });\n    return iteratorFor(items);\n  }\n\n  values() {\n    const items: any[] = [];\n    this.forEach(function (value) {\n      items.push(value);\n    });\n    return iteratorFor(items);\n  }\n\n  entries() {\n    const items: any[] = [];\n    this.forEach(function (value, name) {\n      items.push([name, value]);\n    });\n    return iteratorFor(items);\n  }\n\n  *[Symbol.iterator]() {\n    // @ts-ignore must have a '[Symbol.iterator]()' method that returns an iterator.\n    yield* this.entries();\n  }\n}\n\nfunction normalizeName(name) {\n  if (typeof name !== 'string') {\n    name = String(name);\n  }\n  if (/[^a-z0-9\\-#$%&'*+.^_`|~]/i.test(name) || name === '') {\n    throw new TypeError('Invalid character in header field name');\n  }\n  return name.toLowerCase();\n}\n\nfunction normalizeValue(value) {\n  if (typeof value !== 'string') {\n    value = String(value);\n  }\n  return value;\n}\n\n// Build a destructive iterator for the value list\nfunction iteratorFor(items) {\n  const iterator = {\n    next() {\n      const value = items.shift();\n      return {done: value === undefined, value};\n    }\n  };\n\n  iterator[Symbol.iterator] = function () {\n    return iterator;\n  };\n\n  return iterator;\n}\n"],"mappings":";;mBA+EIA,MAAM,CAACC,QAAQ;AA3EnB,OAAO,MAAMC,OAAO,CAAC;EAGnBC,WAAWA,CAACC,OAAO,EAAE;IAAAC,eAAA;IACnB,IAAI,CAACC,GAAG,GAAG,CAAC,CAAC;IAEb,IAAIF,OAAO,YAAYF,OAAO,EAAE;MAC9BE,OAAO,CAACG,OAAO,CAAC,CAACC,KAAK,EAAEC,IAAI,KAAK,IAAI,CAACC,MAAM,CAACD,IAAI,EAAED,KAAK,CAAC,CAAC;IAC5D,CAAC,MAAM,IAAIG,KAAK,CAACC,OAAO,CAACR,OAAO,CAAC,EAAE;MACjCA,OAAO,CAACG,OAAO,CAAEM,MAAM,IAAK,IAAI,CAACH,MAAM,CAACG,MAAM,CAAC,CAAC,CAAC,EAAEA,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;IAChE,CAAC,MAAM,IAAIT,OAAO,EAAE;MAClBU,MAAM,CAACC,mBAAmB,CAACX,OAAO,CAAC,CAACG,OAAO,CAAEE,IAAI,IAAK,IAAI,CAACC,MAAM,CAACD,IAAI,EAAEL,OAAO,CAACK,IAAI,CAAC,CAAC,CAAC;IACzF;EACF;EAEAC,MAAMA,CAACD,IAAI,EAAED,KAAK,EAAE;IAClBC,IAAI,GAAGO,aAAa,CAACP,IAAI,CAAC;IAC1BD,KAAK,GAAGS,cAAc,CAACT,KAAK,CAAC;IAC7B,MAAMU,QAAQ,GAAG,IAAI,CAACZ,GAAG,CAACG,IAAI,CAAC;IAC/B,IAAI,CAACH,GAAG,CAACG,IAAI,CAAC,GAAGS,QAAQ,MAAAC,MAAA,CAAMD,QAAQ,QAAAC,MAAA,CAAKX,KAAK,IAAKA,KAAK;EAC7D;EAEAY,MAAMA,CAACX,IAAI,EAAE;IACX,OAAO,IAAI,CAACH,GAAG,CAACU,aAAa,CAACP,IAAI,CAAC,CAAC;EACtC;EAEAY,GAAGA,CAACZ,IAAI,EAAE;IACRA,IAAI,GAAGO,aAAa,CAACP,IAAI,CAAC;IAC1B,OAAO,IAAI,CAACa,GAAG,CAACb,IAAI,CAAC,GAAG,IAAI,CAACH,GAAG,CAACG,IAAI,CAAC,GAAG,IAAI;EAC/C;EAEAa,GAAGA,CAACb,IAAI,EAAE;IACR,OAAO,IAAI,CAACH,GAAG,CAACiB,cAAc,CAACP,aAAa,CAACP,IAAI,CAAC,CAAC;EACrD;EAEAe,GAAGA,CAACf,IAAI,EAAED,KAAK,EAAE;IACf,IAAI,CAACF,GAAG,CAACU,aAAa,CAACP,IAAI,CAAC,CAAC,GAAGQ,cAAc,CAACT,KAAK,CAAC;EACvD;EAEAD,OAAOA,CAACkB,OAAO,EAAkB;IAAA,IAAhBC,OAAO,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,IAAI;IAC7B,KAAK,MAAMlB,IAAI,IAAI,IAAI,CAACH,GAAG,EAAE;MAC3B,IAAI,IAAI,CAACA,GAAG,CAACiB,cAAc,CAACd,IAAI,CAAC,EAAE;QACjC,IAAIiB,OAAO,EAAE;UACXD,OAAO,CAACK,IAAI,CAACJ,OAAO,EAAE,IAAI,CAACpB,GAAG,CAACG,IAAI,CAAC,EAAEA,IAAI,EAAE,IAAI,CAAC;QACnD,CAAC,MAAM;UACLgB,OAAO,CAAC,IAAI,CAACnB,GAAG,CAACG,IAAI,CAAC,EAAEA,IAAI,EAAE,IAAI,CAAC;QACrC;MACF;IACF;EACF;EAEAsB,IAAIA,CAAA,EAAG;IACL,MAAMC,KAAY,GAAG,EAAE;IACvB,IAAI,CAACzB,OAAO,CAAC,UAAUC,KAAK,EAAEC,IAAI,EAAE;MAClCuB,KAAK,CAACC,IAAI,CAACxB,IAAI,CAAC;IAClB,CAAC,CAAC;IACF,OAAOyB,WAAW,CAACF,KAAK,CAAC;EAC3B;EAEAG,MAAMA,CAAA,EAAG;IACP,MAAMH,KAAY,GAAG,EAAE;IACvB,IAAI,CAACzB,OAAO,CAAC,UAAUC,KAAK,EAAE;MAC5BwB,KAAK,CAACC,IAAI,CAACzB,KAAK,CAAC;IACnB,CAAC,CAAC;IACF,OAAO0B,WAAW,CAACF,KAAK,CAAC;EAC3B;EAEAI,OAAOA,CAAA,EAAG;IACR,MAAMJ,KAAY,GAAG,EAAE;IACvB,IAAI,CAACzB,OAAO,CAAC,UAAUC,KAAK,EAAEC,IAAI,EAAE;MAClCuB,KAAK,CAACC,IAAI,CAAC,CAACxB,IAAI,EAAED,KAAK,CAAC,CAAC;IAC3B,CAAC,CAAC;IACF,OAAO0B,WAAW,CAACF,KAAK,CAAC;EAC3B;EAEA,EAAAK,gBAAA,IAAqB;IAEnB,OAAO,IAAI,CAACD,OAAO,CAAC,CAAC;EACvB;AACF;AAEA,SAASpB,aAAaA,CAACP,IAAI,EAAE;EAC3B,IAAI,OAAOA,IAAI,KAAK,QAAQ,EAAE;IAC5BA,IAAI,GAAG6B,MAAM,CAAC7B,IAAI,CAAC;EACrB;EACA,IAAI,2BAA2B,CAAC8B,IAAI,CAAC9B,IAAI,CAAC,IAAIA,IAAI,KAAK,EAAE,EAAE;IACzD,MAAM,IAAI+B,SAAS,CAAC,wCAAwC,CAAC;EAC/D;EACA,OAAO/B,IAAI,CAACgC,WAAW,CAAC,CAAC;AAC3B;AAEA,SAASxB,cAAcA,CAACT,KAAK,EAAE;EAC7B,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE;IAC7BA,KAAK,GAAG8B,MAAM,CAAC9B,KAAK,CAAC;EACvB;EACA,OAAOA,KAAK;AACd;AAGA,SAAS0B,WAAWA,CAACF,KAAK,EAAE;EAC1B,MAAM/B,QAAQ,GAAG;IACfyC,IAAIA,CAAA,EAAG;MACL,MAAMlC,KAAK,GAAGwB,KAAK,CAACW,KAAK,CAAC,CAAC;MAC3B,OAAO;QAACC,IAAI,EAAEpC,KAAK,KAAKqB,SAAS;QAAErB;MAAK,CAAC;IAC3C;EACF,CAAC;EAEDP,QAAQ,CAACD,MAAM,CAACC,QAAQ,CAAC,GAAG,YAAY;IACtC,OAAOA,QAAQ;EACjB,CAAC;EAED,OAAOA,QAAQ;AACjB"}