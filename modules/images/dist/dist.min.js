(()=>{var Y=Object.defineProperty;var Le=e=>Y(e,"__esModule",{value:!0});var n=(e,t)=>()=>(e&&(t=e(e=0)),t);var Pe=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Oe=(e,t)=>{Le(e);for(var r in t)Y(e,r,{get:t[r],enumerable:!0})};var T,P=n(()=>{T=typeof __VERSION__!="undefined"?__VERSION__:"latest"});function f(e,t){if(!e)throw new Error(t||"loader assertion failed.")}var J=n(()=>{});var p,Me,Ue,ve,ke,u,X,Ne,Z=n(()=>{p={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,global:typeof global!="undefined"&&global,document:typeof document!="undefined"&&document},Me=p.self||p.window||p.global||{},Ue=p.window||p.self||p.global||{},ve=p.global||p.self||p.window||{},ke=p.document||{},u=Boolean(typeof process!="object"||String(process)!=="[object process]"||process.browser),X=typeof process!="undefined"&&process.version&&/v([0-9]*)/.exec(process.version),Ne=X&&parseFloat(X[1])||0});function O(e){for(let t in q)if(e.startsWith(t)){let r=q[t];e=e.replace(t,r)}return!e.startsWith("http://")&&!e.startsWith("https://")&&(e=`${_e}${e}`),e}var _e,q,z=n(()=>{_e="",q={}});var l=n(()=>{J();Z();z()});function B(e){switch(e){case"auto":return U||M||v;case"imagebitmap":return U;case"image":return M;case"data":return v;default:throw new Error(`@loaders.gl/images: image ${e} not supported in this environment`)}}function D(){if(U)return"imagebitmap";if(M)return"image";if(v)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}var Ve,M,U,Re,v,k=n(()=>{l();({_parseImageNode:Ve}=globalThis),M=typeof Image!="undefined",U=typeof ImageBitmap!="undefined",Re=Boolean(Ve),v=u?!0:Re});function H(e){return Boolean(K(e))}function N(e){let t=K(e);if(!t)throw new Error("Not an image");return t}function d(e){return b(e)}function b(e){switch(N(e)){case"data":return e;case"image":case"imagebitmap":let t=document.createElement("canvas"),r=t.getContext("2d");if(!r)throw new Error("getImageData");return t.width=e.width,t.height=e.height,r.drawImage(e,0,0),r.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}function K(e){return typeof ImageBitmap!="undefined"&&e instanceof ImageBitmap?"imagebitmap":typeof Image!="undefined"&&e instanceof Image?"image":e&&typeof e=="object"&&e.data&&e.width&&e.height?"data":null}var I=n(()=>{});function S(e){return e&&(Fe.test(e)||We.test(e))}function ee(e,t){if(S(t)){let a=new TextDecoder().decode(e);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(a=unescape(encodeURIComponent(a)))}catch(i){throw new Error(i.message)}return`data:image/svg+xml;base64,${btoa(a)}`}return _(e,t)}function _(e,t){if(S(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}var Fe,We,V=n(()=>{Fe=/^data:image\/svg\+xml/,We=/\.svg((\?|#).*)?$/});async function w(e,t,r){let a=ee(e,r),o=self.URL||self.webkitURL,i=typeof a!="string"&&o.createObjectURL(a);try{return await je(i||a,t)}finally{i&&o.revokeObjectURL(i)}}async function je(e,t){let r=new Image;return r.src=e,t.image&&t.image.decode&&r.decode?(await r.decode(),r):await new Promise((a,o)=>{try{r.onload=()=>a(r),r.onerror=i=>o(new Error(`Could not load image ${e}: ${i}`))}catch(i){o(i)}})}var R=n(()=>{V()});async function F(e,t,r){let a;S(r)?a=await w(e,t,r):a=_(e,r);let o=t&&t.imagebitmap;return await Ce(a,o)}async function Ce(e,t=null){if((Qe(t)||!te)&&(t=null),t)try{return await createImageBitmap(e,t)}catch(r){console.warn(r),te=!1}return await createImageBitmap(e)}function Qe(e){for(let t in e||Ge)return!1;return!0}var Ge,te,re=n(()=>{V();R();Ge={},te=!0});function ae(e){return!Xe(e,"ftyp",4)||(e[8]&96)==0?null:$e(e)}function $e(e){switch(Ye(e,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function Ye(e,t,r){return String.fromCharCode(...e.slice(t,r))}function Je(e){return[...e].map(t=>t.charCodeAt(0))}function Xe(e,t,r=0){let a=Je(t);for(let o=0;o<a.length;++o)if(a[o]!==e[o+r])return!1;return!0}var oe=n(()=>{});function y(e){let t=h(e);return qe(t)||Ke(t)||ze(t)||He(t)||Ze(t)}function Ze(e){let t=new Uint8Array(e instanceof DataView?e.buffer:e),r=ae(t);return r?{mimeType:r.mimeType,width:0,height:0}:null}function qe(e){let t=h(e);return t.byteLength>=24&&t.getUint32(0,g)===2303741511?{mimeType:"image/png",width:t.getUint32(16,g),height:t.getUint32(20,g)}:null}function ze(e){let t=h(e);return t.byteLength>=10&&t.getUint32(0,g)===1195984440?{mimeType:"image/gif",width:t.getUint16(6,x),height:t.getUint16(8,x)}:null}function He(e){let t=h(e);return t.byteLength>=14&&t.getUint16(0,g)===16973&&t.getUint32(2,x)===t.byteLength?{mimeType:"image/bmp",width:t.getUint32(18,x),height:t.getUint32(22,x)}:null}function Ke(e){let t=h(e);if(!(t.byteLength>=3&&t.getUint16(0,g)===65496&&t.getUint8(2)===255))return null;let{tableMarkers:a,sofMarkers:o}=et(),i=2;for(;i+9<t.byteLength;){let s=t.getUint16(i,g);if(o.has(s))return{mimeType:"image/jpeg",height:t.getUint16(i+5,g),width:t.getUint16(i+7,g)};if(!a.has(s))return null;i+=2,i+=t.getUint16(i,g)}return null}function et(){let e=new Set([65499,65476,65484,65501,65534]);for(let r=65504;r<65520;++r)e.add(r);let t=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:e,sofMarkers:t}}function h(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}var g,x,E=n(()=>{oe();g=!1,x=!0});async function W(e,t){let{mimeType:r}=y(e)||{},a=globalThis._parseImageNode;return f(a),await a(e,r)}var ie=n(()=>{l();E()});async function A(e,t,r){t=t||{};let o=(t.image||{}).type||"auto",{url:i}=r||{},s=tt(o),m;switch(s){case"imagebitmap":m=await F(e,t,i);break;case"image":m=await w(e,t,i);break;case"data":m=await W(e,t);break;default:f(!1)}return o==="data"&&(m=b(m)),m}function tt(e){switch(e){case"auto":case"data":return D();default:return B(e),e}}var j=n(()=>{l();k();I();R();re();ie()});var rt,at,ot,ne,se=n(()=>{P();j();E();rt=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],at=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],ot={image:{type:"auto",decode:!0}},ne={id:"image",module:"images",name:"Images",version:T,mimeTypes:at,extensions:rt,parse:A,tests:[e=>Boolean(y(new DataView(e)))],options:ot}});async function pe(e,t){return t=t||{},t.image=t.image||{},me?me(e,{type:t.image.mimeType}):it(e,t)}async function it(e,t){let{mimeType:r,jpegQuality:a}=t.image,{width:o,height:i}=d(e),s=document.createElement("canvas");s.width=o,s.height=i,nt(e,s);let m=await new Promise(c=>{if(a&&ge)try{s.toBlob(c,r,a);return}catch{ge=!1}s.toBlob(c,r)});if(!m)throw new Error("image encoding failed");return await m.arrayBuffer()}function nt(e,t,r=0,a=0){if(r===0&&a===0&&typeof ImageBitmap!="undefined"&&e instanceof ImageBitmap){let i=t.getContext("bitmaprenderer");if(i)return i.transferFromImageBitmap(e),t}let o=t.getContext("2d");if(e.data){let i=new Uint8ClampedArray(e.data),s=new ImageData(i,e.width,e.height);return o.putImageData(s,0,0),t}return o.drawImage(e,0,0),t}var me,ge,fe=n(()=>{I();({_encodeImageNode:me}=globalThis);ge=!0});var le,ce=n(()=>{P();fe();le={name:"Images",id:"image",module:"images",version:T,extensions:["jpeg"],options:{image:{mimeType:"image/png",jpegQuality:null}},encode:pe}});async function de(){if(ue)return await ue;let e=new Set;for(let t of st)(u?await gt(t):Ae(t))&&e.add(t);return e}function ye(e){if(G[e]===void 0){let t=u?mt(e):Ae(e);G[e]=t}return G[e]}function Ae(e){let t=["image/png","image/jpeg","image/gif"],{_parseImageNode:r,_imageFormatsNode:a=t}=globalThis;return Boolean(r)&&a.includes(e)}function mt(e){switch(e){case"image/avif":case"image/webp":return ft(e);default:return!0}}async function gt(e){let t=pt[e];return t?await lt(t):!0}function ft(e){try{return document.createElement("canvas").toDataURL(e).indexOf(`data:${e}`)===0}catch{return!1}}async function lt(e){return new Promise(t=>{let r=new Image;r.src=e,r.onload=()=>t(r.height>0),r.onerror=()=>t(!1)})}var st,ue,G,pt,C=n(()=>{l();st=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/tiff","image/svg","image/svg+xml","image/bmp","image/vnd.microsoft.icon"],ue=null;G={};pt={"image/avif":"data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=","image/webp":"data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA"}});function L(e,t,r){let a=e;typeof e=="function"&&(a=e({...t,...r})),f(typeof a=="string");let{baseUrl:o}=t;return o&&(a=o[o.length-1]==="/"?`${o}${a}`:`${o}/${a}`),O(a)}var be=n(()=>{l()});async function Ie(e,t,r={}){return await Q(e,t,r)}async function Q(e,t,r){return Array.isArray(e)?await dt(e,t,r):ct(e)?await ut(e,t,r):await t(e,r)}async function ut(e,t,r){let a=[],o={};for(let i in e){let s=e[i],m=Q(s,t,r).then(c=>{o[i]=c});a.push(m)}return await Promise.all(a),o}async function dt(e,t,r={}){let a=e.map(o=>Q(o,t,r));return await Promise.all(a)}var ct,we=n(()=>{ct=e=>e&&typeof e=="object"});async function xe(e,t,r){return await Ie(e,a=>$(a,t,r))}async function $(e,t,r){let o=await(await fetch(e,r.fetch)).arrayBuffer();return await t(o,r)}var he=n(()=>{we()});async function Te(e,t={}){let r=await yt(e,t);return await xe(r,A,t)}async function yt(e,t,r={}){let a=t&&t.image&&t.image.mipLevels||0;return a!==0?await At(e,a,t,r):L(e,t,r)}async function At(e,t,r,a){let o=[];if(t==="auto"){let i=L(e,r,{...a,lod:0}),s=await $(i,A,r),{width:m,height:c}=d(s);t=bt({width:m,height:c}),o.push(i)}f(t>0);for(let i=o.length;i<t;++i){let s=L(e,r,{...a,lod:i});o.push(s)}return o}function bt({width:e,height:t}){return 1+Math.floor(Math.log2(Math.max(e,t)))}var Be=n(()=>{l();j();I();be();he()});var De={};Oe(De,{ImageLoader:()=>ne,ImageWriter:()=>le,getBinaryImageMetadata:()=>y,getDefaultImageType:()=>D,getImageData:()=>b,getImageSize:()=>d,getImageType:()=>N,getSupportedImageFormats:()=>de,isImage:()=>H,isImageFormatSupported:()=>ye,isImageTypeSupported:()=>B,loadImage:()=>Te});var Se=n(()=>{se();ce();E();k();I();C();C();Be()});var wt=Pe((Ur,Ee)=>{var It=(Se(),De);globalThis.loaders=globalThis.loaders||{};Ee.exports=Object.assign(globalThis.loaders,It)});wt();})();
//# sourceMappingURL=dist.min.js.map
