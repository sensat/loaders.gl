{"version":3,"file":"load-zarr.js","names":["loadMultiscales","guessTileSize","guessLabels","normalizeStore","validLabels","ZarrPixelSource","loadZarr","root","_options$labels","options","arguments","length","undefined","store","data","rootAttrs","tileSize","labels","shape","Error","pyramid","map","arr","metadata"],"sources":["../../../src/lib/load-zarr.ts"],"sourcesContent":["// eslint-disable-next-line import/no-unresolved\nimport type {Store} from 'zarr/types/storage/types';\nimport {loadMultiscales, guessTileSize, guessLabels, normalizeStore, validLabels} from './utils';\nimport ZarrPixelSource from './zarr-pixel-source';\n\ninterface ZarrOptions {\n  labels?: string[];\n}\n\nexport async function loadZarr(root: string | Store, options: ZarrOptions = {}) {\n  const store = normalizeStore(root);\n  const {data, rootAttrs} = await loadMultiscales(store);\n  const tileSize = guessTileSize(data[0]);\n\n  // If no labels are provided, inspect the root attributes for the store.\n  // For now, we only infer labels for OME-Zarr.\n  const labels = options.labels ?? guessLabels(rootAttrs);\n\n  if (!validLabels(labels, data[0].shape)) {\n    throw new Error('Invalid labels for Zarr array dimensions.');\n  }\n\n  const pyramid = data.map((arr) => new ZarrPixelSource(arr, labels, tileSize));\n  return {\n    data: pyramid,\n    metadata: rootAttrs\n  };\n}\n"],"mappings":"AAEA,SAAQA,eAAe,EAAEC,aAAa,EAAEC,WAAW,EAAEC,cAAc,EAAEC,WAAW,QAAO,SAAS;AAChG,OAAOC,eAAe,MAAM,qBAAqB;AAMjD,OAAO,eAAeC,QAAQA,CAACC,IAAoB,EAA6B;EAAA,IAAAC,eAAA;EAAA,IAA3BC,OAAoB,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,CAAC,CAAC;EAC5E,MAAMG,KAAK,GAAGV,cAAc,CAACI,IAAI,CAAC;EAClC,MAAM;IAACO,IAAI;IAAEC;EAAS,CAAC,GAAG,MAAMf,eAAe,CAACa,KAAK,CAAC;EACtD,MAAMG,QAAQ,GAAGf,aAAa,CAACa,IAAI,CAAC,CAAC,CAAC,CAAC;EAIvC,MAAMG,MAAM,IAAAT,eAAA,GAAGC,OAAO,CAACQ,MAAM,cAAAT,eAAA,cAAAA,eAAA,GAAIN,WAAW,CAACa,SAAS,CAAC;EAEvD,IAAI,CAACX,WAAW,CAACa,MAAM,EAAEH,IAAI,CAAC,CAAC,CAAC,CAACI,KAAK,CAAC,EAAE;IACvC,MAAM,IAAIC,KAAK,CAAC,2CAA2C,CAAC;EAC9D;EAEA,MAAMC,OAAO,GAAGN,IAAI,CAACO,GAAG,CAAEC,GAAG,IAAK,IAAIjB,eAAe,CAACiB,GAAG,EAAEL,MAAM,EAAED,QAAQ,CAAC,CAAC;EAC7E,OAAO;IACLF,IAAI,EAAEM,OAAO;IACbG,QAAQ,EAAER;EACZ,CAAC;AACH"}