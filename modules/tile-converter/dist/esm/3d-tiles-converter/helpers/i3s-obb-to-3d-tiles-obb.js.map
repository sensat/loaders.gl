{"version":3,"file":"i3s-obb-to-3d-tiles-obb.js","names":["Vector3","Ellipsoid","OrientedBoundingBox","i3sObbTo3dTilesObb","i3SObb","geoidHeightModel","tiles3DCenter","center","getHeight","cartesianCenter","WGS84","cartographicToCartesian","tiles3DObb","fromCenterHalfSizeQuaternion","halfSize","quaternion","halfAxes","toArray"],"sources":["../../../../src/3d-tiles-converter/helpers/i3s-obb-to-3d-tiles-obb.ts"],"sourcesContent":["import {Vector3} from '@math.gl/core';\nimport {Ellipsoid} from '@math.gl/geospatial';\nimport {OrientedBoundingBox} from '@math.gl/culling';\n// @ts-expect-error\nimport {GeoidHeightModel} from '@loaders.gl/tile-converter/lib/geoid-height-model';\n\n/**\n * Convert quaternion-based OBB to half-axes-based OBB\n * @param i3SObb quaternion based OBB\n * @param geoidHeightModel the Earth Gravity Model instance\n * @returns number[12] 3DTiles OBB https://github.com/CesiumGS/3d-tiles/tree/master/specification#box\n */\nexport function i3sObbTo3dTilesObb(\n  i3SObb: {\n    center: number[];\n    halfSize: number[];\n    quaternion: number[];\n  },\n  geoidHeightModel: GeoidHeightModel\n): number[] {\n  const tiles3DCenter = [\n    i3SObb.center[0],\n    i3SObb.center[1],\n    i3SObb.center[2] + geoidHeightModel.getHeight(i3SObb.center[1], i3SObb.center[0])\n  ];\n  const cartesianCenter = Ellipsoid.WGS84.cartographicToCartesian(tiles3DCenter, new Vector3());\n  const tiles3DObb = new OrientedBoundingBox().fromCenterHalfSizeQuaternion(\n    cartesianCenter,\n    i3SObb.halfSize,\n    i3SObb.quaternion\n  );\n  return [...tiles3DObb.center, ...tiles3DObb.halfAxes.toArray()];\n}\n"],"mappings":"AAAA,SAAQA,OAAO,QAAO,eAAe;AACrC,SAAQC,SAAS,QAAO,qBAAqB;AAC7C,SAAQC,mBAAmB,QAAO,kBAAkB;AAUpD,OAAO,SAASC,kBAAkBA,CAChCC,MAIC,EACDC,gBAAkC,EACxB;EACV,MAAMC,aAAa,GAAG,CACpBF,MAAM,CAACG,MAAM,CAAC,CAAC,CAAC,EAChBH,MAAM,CAACG,MAAM,CAAC,CAAC,CAAC,EAChBH,MAAM,CAACG,MAAM,CAAC,CAAC,CAAC,GAAGF,gBAAgB,CAACG,SAAS,CAACJ,MAAM,CAACG,MAAM,CAAC,CAAC,CAAC,EAAEH,MAAM,CAACG,MAAM,CAAC,CAAC,CAAC,CAAC,CAClF;EACD,MAAME,eAAe,GAAGR,SAAS,CAACS,KAAK,CAACC,uBAAuB,CAACL,aAAa,EAAE,IAAIN,OAAO,CAAC,CAAC,CAAC;EAC7F,MAAMY,UAAU,GAAG,IAAIV,mBAAmB,CAAC,CAAC,CAACW,4BAA4B,CACvEJ,eAAe,EACfL,MAAM,CAACU,QAAQ,EACfV,MAAM,CAACW,UACT,CAAC;EACD,OAAO,CAAC,GAAGH,UAAU,CAACL,MAAM,EAAE,GAAGK,UAAU,CAACI,QAAQ,CAACC,OAAO,CAAC,CAAC,CAAC;AACjE"}