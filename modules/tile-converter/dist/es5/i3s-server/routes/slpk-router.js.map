{"version":3,"file":"slpk-router.js","names":["express","require","_require","getFileByUrl","createSceneServer","sceneServerRouter","Router","get","_ref","_asyncToGenerator2","default","_regenerator","mark","_callee","req","res","next","file","layer","sceneServerResponse","wrap","_callee$","_context","prev","sent","JSON","parse","toString","name","send","status","stop","_x","_x2","_x3","apply","arguments","router","_ref2","_callee2","_callee2$","_context2","console","log","path","_x4","_x5","_x6","module","exports"],"sources":["../../../../src/i3s-server/routes/slpk-router.js"],"sourcesContent":["const express = require('express');\nconst {getFileByUrl} = require('../controllers/slpk-controller');\nconst createSceneServer = require('../utils/create-scene-server');\n\nconst sceneServerRouter = express.Router();\nsceneServerRouter.get('*', async function (req, res, next) {\n  const file = await getFileByUrl('/');\n  if (file) {\n    const layer = JSON.parse(file.toString());\n    const sceneServerResponse = createSceneServer(layer.name, layer);\n    res.send(sceneServerResponse);\n  } else {\n    res.status(404);\n    res.send('File not found');\n  }\n});\n\nconst router = express.Router();\nrouter.get('*', async function (req, res, next) {\n  console.log(req.path);\n  const file = await getFileByUrl(req.path);\n  if (file) {\n    res.send(file);\n  } else {\n    res.status(404);\n    res.send('File not found');\n  }\n});\n\nmodule.exports = {\n  sceneServerRouter,\n  router\n};\n"],"mappings":";;;;;AAAA,IAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,IAAAC,QAAA,GAAuBD,OAAO,CAAC,gCAAgC,CAAC;EAAzDE,YAAY,GAAAD,QAAA,CAAZC,YAAY;AACnB,IAAMC,iBAAiB,GAAGH,OAAO,CAAC,8BAA8B,CAAC;AAEjE,IAAMI,iBAAiB,GAAGL,OAAO,CAACM,MAAM,CAAC,CAAC;AAC1CD,iBAAiB,CAACE,GAAG,CAAC,GAAG;EAAA,IAAAC,IAAA,OAAAC,kBAAA,CAAAC,OAAA,EAAAC,YAAA,CAAAD,OAAA,CAAAE,IAAA,CAAE,SAAAC,QAAgBC,GAAG,EAAEC,GAAG,EAAEC,IAAI;IAAA,IAAAC,IAAA,EAAAC,KAAA,EAAAC,mBAAA;IAAA,OAAAR,YAAA,CAAAD,OAAA,CAAAU,IAAA,UAAAC,SAAAC,QAAA;MAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAN,IAAA;QAAA;UAAAM,QAAA,CAAAN,IAAA;UAAA,OACpCb,YAAY,CAAC,GAAG,CAAC;QAAA;UAA9Bc,IAAI,GAAAK,QAAA,CAAAE,IAAA;UACV,IAAIP,IAAI,EAAE;YACFC,KAAK,GAAGO,IAAI,CAACC,KAAK,CAACT,IAAI,CAACU,QAAQ,CAAC,CAAC,CAAC;YACnCR,mBAAmB,GAAGf,iBAAiB,CAACc,KAAK,CAACU,IAAI,EAAEV,KAAK,CAAC;YAChEH,GAAG,CAACc,IAAI,CAACV,mBAAmB,CAAC;UAC/B,CAAC,MAAM;YACLJ,GAAG,CAACe,MAAM,CAAC,GAAG,CAAC;YACff,GAAG,CAACc,IAAI,CAAC,gBAAgB,CAAC;UAC5B;QAAC;QAAA;UAAA,OAAAP,QAAA,CAAAS,IAAA;MAAA;IAAA,GAAAlB,OAAA;EAAA,CACF;EAAA,iBAAAmB,EAAA,EAAAC,GAAA,EAAAC,GAAA;IAAA,OAAA1B,IAAA,CAAA2B,KAAA,OAAAC,SAAA;EAAA;AAAA,IAAC;AAEF,IAAMC,MAAM,GAAGrC,OAAO,CAACM,MAAM,CAAC,CAAC;AAC/B+B,MAAM,CAAC9B,GAAG,CAAC,GAAG;EAAA,IAAA+B,KAAA,OAAA7B,kBAAA,CAAAC,OAAA,EAAAC,YAAA,CAAAD,OAAA,CAAAE,IAAA,CAAE,SAAA2B,SAAgBzB,GAAG,EAAEC,GAAG,EAAEC,IAAI;IAAA,IAAAC,IAAA;IAAA,OAAAN,YAAA,CAAAD,OAAA,CAAAU,IAAA,UAAAoB,UAAAC,SAAA;MAAA,kBAAAA,SAAA,CAAAlB,IAAA,GAAAkB,SAAA,CAAAzB,IAAA;QAAA;UAC5C0B,OAAO,CAACC,GAAG,CAAC7B,GAAG,CAAC8B,IAAI,CAAC;UAACH,SAAA,CAAAzB,IAAA;UAAA,OACHb,YAAY,CAACW,GAAG,CAAC8B,IAAI,CAAC;QAAA;UAAnC3B,IAAI,GAAAwB,SAAA,CAAAjB,IAAA;UACV,IAAIP,IAAI,EAAE;YACRF,GAAG,CAACc,IAAI,CAACZ,IAAI,CAAC;UAChB,CAAC,MAAM;YACLF,GAAG,CAACe,MAAM,CAAC,GAAG,CAAC;YACff,GAAG,CAACc,IAAI,CAAC,gBAAgB,CAAC;UAC5B;QAAC;QAAA;UAAA,OAAAY,SAAA,CAAAV,IAAA;MAAA;IAAA,GAAAQ,QAAA;EAAA,CACF;EAAA,iBAAAM,GAAA,EAAAC,GAAA,EAAAC,GAAA;IAAA,OAAAT,KAAA,CAAAH,KAAA,OAAAC,SAAA;EAAA;AAAA,IAAC;AAEFY,MAAM,CAACC,OAAO,GAAG;EACf5C,iBAAiB,EAAjBA,iBAAiB;EACjBgC,MAAM,EAANA;AACF,CAAC"}