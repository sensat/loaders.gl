{"version":3,"file":"app.js","names":["express","require","path","logger","cors","indexRouter","_require","sceneServerRouter","router","I3S_LAYER_PATH","process","env","I3sLayerPath","app","use","json","urlencoded","extended","static","join","__dirname","test","module","exports"],"sources":["../../../src/i3s-server/app.js"],"sourcesContent":["const express = require('express');\nconst path = require('path');\nconst logger = require('morgan');\nconst cors = require('cors');\n\nconst indexRouter = require('./routes/index');\nconst {sceneServerRouter, router} = require('./routes/slpk-router');\n\nconst I3S_LAYER_PATH = process.env.I3sLayerPath || ''; // eslint-disable-line no-process-env, no-undef\nconst app = express();\n\napp.use(logger('dev'));\napp.use(express.json());\napp.use(express.urlencoded({extended: false}));\napp.use(express.static(path.join(__dirname, 'public')));\napp.use(cors());\n\nif (/\\.slpk$/.test(I3S_LAYER_PATH)) {\n  app.use('/SceneServer/layers/0', router);\n  app.use('/SceneServer', sceneServerRouter);\n} else {\n  app.use('/', indexRouter);\n}\n\nmodule.exports = app;\n"],"mappings":";;AAAA,IAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,IAAMC,IAAI,GAAGD,OAAO,CAAC,MAAM,CAAC;AAC5B,IAAME,MAAM,GAAGF,OAAO,CAAC,QAAQ,CAAC;AAChC,IAAMG,IAAI,GAAGH,OAAO,CAAC,MAAM,CAAC;AAE5B,IAAMI,WAAW,GAAGJ,OAAO,CAAC,gBAAgB,CAAC;AAC7C,IAAAK,QAAA,GAAoCL,OAAO,CAAC,sBAAsB,CAAC;EAA5DM,iBAAiB,GAAAD,QAAA,CAAjBC,iBAAiB;EAAEC,MAAM,GAAAF,QAAA,CAANE,MAAM;AAEhC,IAAMC,cAAc,GAAGC,OAAO,CAACC,GAAG,CAACC,YAAY,IAAI,EAAE;AACrD,IAAMC,GAAG,GAAGb,OAAO,CAAC,CAAC;AAErBa,GAAG,CAACC,GAAG,CAACX,MAAM,CAAC,KAAK,CAAC,CAAC;AACtBU,GAAG,CAACC,GAAG,CAACd,OAAO,CAACe,IAAI,CAAC,CAAC,CAAC;AACvBF,GAAG,CAACC,GAAG,CAACd,OAAO,CAACgB,UAAU,CAAC;EAACC,QAAQ,EAAE;AAAK,CAAC,CAAC,CAAC;AAC9CJ,GAAG,CAACC,GAAG,CAACd,OAAO,CAACkB,MAAM,CAAChB,IAAI,CAACiB,IAAI,CAACC,SAAS,EAAE,QAAQ,CAAC,CAAC,CAAC;AACvDP,GAAG,CAACC,GAAG,CAACV,IAAI,CAAC,CAAC,CAAC;AAEf,IAAI,SAAS,CAACiB,IAAI,CAACZ,cAAc,CAAC,EAAE;EAClCI,GAAG,CAACC,GAAG,CAAC,uBAAuB,EAAEN,MAAM,CAAC;EACxCK,GAAG,CAACC,GAAG,CAAC,cAAc,EAAEP,iBAAiB,CAAC;AAC5C,CAAC,MAAM;EACLM,GAAG,CAACC,GAAG,CAAC,GAAG,EAAET,WAAW,CAAC;AAC3B;AAEAiB,MAAM,CAACC,OAAO,GAAGV,GAAG"}