{"version":3,"file":"load-3d-tiles.js","names":["_core","require","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty2","default","getOwnPropertyDescriptors","defineProperties","defineProperty","loadNestedTileset","_ref","_asyncToGenerator2","_regenerator","mark","_callee","sourceTileset","sourceTile","tilesetLoadOptions","isTileset","loadOptions","tileContent","wrap","_callee$","_context","prev","next","type","contentUrl","abrupt","loader","id","assetGltfUpAxis","asset","gltfUpAxis","load","sent","root","children","stop","_x","_x2","_x3","exports","loadTile3DContent","_ref2","_callee2","_callee2$","_context2","_x4","_x5","_x6"],"sources":["../../../../src/i3s-converter/helpers/load-3d-tiles.ts"],"sourcesContent":["import type {\n  Tiles3DLoaderOptions,\n  Tiles3DTileContent,\n  Tiles3DTileJSONPostprocessed,\n  Tiles3DTilesetJSONPostprocessed\n} from '@loaders.gl/3d-tiles';\nimport {load} from '@loaders.gl/core';\n\n/**\n * Load nested 3DTiles tileset. If the sourceTile is not nested tileset - do nothing\n * @param sourceTileset - source root tileset JSON\n * @param sourceTile - source tile JSON that is supposed to has link to nested tileset\n * @param tilesetLoadOptions - load options for Tiles3DLoader\n * @returns nothing\n */\nexport const loadNestedTileset = async (\n  sourceTileset: Tiles3DTilesetJSONPostprocessed | null,\n  sourceTile: Tiles3DTileJSONPostprocessed,\n  tilesetLoadOptions: Tiles3DLoaderOptions\n): Promise<void> => {\n  const isTileset = sourceTile.type === 'json';\n  if (!sourceTileset || !sourceTile.contentUrl || !isTileset) {\n    return;\n  }\n\n  const loadOptions = {\n    ...tilesetLoadOptions,\n    [sourceTileset.loader.id]: {\n      isTileset,\n      assetGltfUpAxis: (sourceTileset.asset && sourceTileset.asset.gltfUpAxis) || 'Y'\n    }\n  };\n  const tileContent = await load(sourceTile.contentUrl, sourceTileset.loader, loadOptions);\n\n  if (tileContent.root) {\n    sourceTile.children = [tileContent.root];\n  }\n};\n\n/**\n * Load 3DTiles tile content, that includes glTF object\n * @param sourceTileset - source root tileset JSON\n * @param sourceTile - source tile JSON that has link to content data\n * @param tilesetLoadOptions - load options for Tiles3DLoader\n * @returns - 3DTiles tile content or null\n */\nexport const loadTile3DContent = async (\n  sourceTileset: Tiles3DTilesetJSONPostprocessed | null,\n  sourceTile: Tiles3DTileJSONPostprocessed,\n  tilesetLoadOptions: Tiles3DLoaderOptions\n): Promise<Tiles3DTileContent | null> => {\n  const isTileset = sourceTile.type === 'json';\n  if (!sourceTileset || !sourceTile.contentUrl || isTileset) {\n    return null;\n  }\n\n  const loadOptions = {\n    ...tilesetLoadOptions,\n    [sourceTileset.loader.id]: {\n      ...(tilesetLoadOptions[sourceTileset.loader.id] || {}),\n      isTileset,\n      assetGltfUpAxis: (sourceTileset.asset && sourceTileset.asset.gltfUpAxis) || 'Y'\n    }\n  };\n  const tileContent = await load(sourceTile.contentUrl, sourceTileset.loader, loadOptions);\n\n  return tileContent;\n};\n"],"mappings":"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"}