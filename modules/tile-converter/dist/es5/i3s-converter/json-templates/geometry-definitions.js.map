{"version":3,"file":"geometry-definitions.js","names":["_jsonMapTransform","_interopRequireDefault","require","PLAIN_GEOMETRY_DEFINITION","offset","default","position","type","component","normal","uv0","path","transform","val","omitValues","color","uvRegion","featureId","binding","faceRange","COMPRESSED_GEOMETRY_DEFINITION","result","hasTexture","push","hasUvRegions","GEOMETRY_DEFINITION","geometryBuffers","draco","geometryConfig","exports"],"sources":["../../../../src/i3s-converter/json-templates/geometry-definitions.ts"],"sourcesContent":["import transform from 'json-map-transform';\n\nconst PLAIN_GEOMETRY_DEFINITION = () => ({\n  offset: {\n    default: 8\n  },\n  position: {\n    default: {\n      type: 'Float32',\n      component: 3\n    }\n  },\n  normal: {\n    default: {\n      type: 'Float32',\n      component: 3\n    }\n  },\n  uv0: {\n    path: 'hasTexture',\n    transform: (val) => (val && {type: 'Float32', component: 2}) || false,\n    omitValues: [false]\n  },\n  color: {\n    default: {\n      type: 'UInt8',\n      component: 4\n    }\n  },\n  uvRegion: {\n    path: 'hasUvRegions',\n    transform: (val) => (val && {type: 'UInt16', component: 4}) || false,\n    omitValues: [false]\n  },\n  featureId: {\n    default: {\n      binding: 'per-feature',\n      type: 'UInt64',\n      component: 1\n    }\n  },\n  faceRange: {\n    default: {\n      binding: 'per-feature',\n      type: 'UInt32',\n      component: 2\n    }\n  }\n});\n\nconst COMPRESSED_GEOMETRY_DEFINITION = () => ({\n  'compressedAttributes.encoding': {\n    default: 'draco'\n  },\n  'compressedAttributes.attributes': {\n    path: 'geometryConfig',\n    transform: (val) => {\n      const result = ['position', 'normal'];\n      if (val.hasTexture) {\n        result.push('uv0');\n      }\n      result.push('color');\n      if (val.hasUvRegions) {\n        result.push('uv-region');\n      }\n      result.push('feature-index');\n      return result;\n    }\n  }\n});\n\nexport const GEOMETRY_DEFINITION = () => ({\n  geometryBuffers: {\n    path: 'geometryConfig',\n    transform: (val) => {\n      const result = [transform(val, PLAIN_GEOMETRY_DEFINITION())];\n      if (val.draco) {\n        result.push(transform({geometryConfig: val}, COMPRESSED_GEOMETRY_DEFINITION()));\n      }\n      return result;\n    }\n  }\n});\n"],"mappings":";;;;;;;AAAA,IAAAA,iBAAA,GAAAC,sBAAA,CAAAC,OAAA;AAEA,IAAMC,yBAAyB,GAAG,SAA5BA,yBAAyBA,CAAA;EAAA,OAAU;IACvCC,MAAM,EAAE;MACNC,OAAO,EAAE;IACX,CAAC;IACDC,QAAQ,EAAE;MACRD,OAAO,EAAE;QACPE,IAAI,EAAE,SAAS;QACfC,SAAS,EAAE;MACb;IACF,CAAC;IACDC,MAAM,EAAE;MACNJ,OAAO,EAAE;QACPE,IAAI,EAAE,SAAS;QACfC,SAAS,EAAE;MACb;IACF,CAAC;IACDE,GAAG,EAAE;MACHC,IAAI,EAAE,YAAY;MAClBC,SAAS,EAAE,SAAAA,UAACC,GAAG;QAAA,OAAMA,GAAG,IAAI;UAACN,IAAI,EAAE,SAAS;UAAEC,SAAS,EAAE;QAAC,CAAC,IAAK,KAAK;MAAA;MACrEM,UAAU,EAAE,CAAC,KAAK;IACpB,CAAC;IACDC,KAAK,EAAE;MACLV,OAAO,EAAE;QACPE,IAAI,EAAE,OAAO;QACbC,SAAS,EAAE;MACb;IACF,CAAC;IACDQ,QAAQ,EAAE;MACRL,IAAI,EAAE,cAAc;MACpBC,SAAS,EAAE,SAAAA,UAACC,GAAG;QAAA,OAAMA,GAAG,IAAI;UAACN,IAAI,EAAE,QAAQ;UAAEC,SAAS,EAAE;QAAC,CAAC,IAAK,KAAK;MAAA;MACpEM,UAAU,EAAE,CAAC,KAAK;IACpB,CAAC;IACDG,SAAS,EAAE;MACTZ,OAAO,EAAE;QACPa,OAAO,EAAE,aAAa;QACtBX,IAAI,EAAE,QAAQ;QACdC,SAAS,EAAE;MACb;IACF,CAAC;IACDW,SAAS,EAAE;MACTd,OAAO,EAAE;QACPa,OAAO,EAAE,aAAa;QACtBX,IAAI,EAAE,QAAQ;QACdC,SAAS,EAAE;MACb;IACF;EACF,CAAC;AAAA,CAAC;AAEF,IAAMY,8BAA8B,GAAG,SAAjCA,8BAA8BA,CAAA;EAAA,OAAU;IAC5C,+BAA+B,EAAE;MAC/Bf,OAAO,EAAE;IACX,CAAC;IACD,iCAAiC,EAAE;MACjCM,IAAI,EAAE,gBAAgB;MACtBC,SAAS,EAAE,SAAAA,UAACC,GAAG,EAAK;QAClB,IAAMQ,MAAM,GAAG,CAAC,UAAU,EAAE,QAAQ,CAAC;QACrC,IAAIR,GAAG,CAACS,UAAU,EAAE;UAClBD,MAAM,CAACE,IAAI,CAAC,KAAK,CAAC;QACpB;QACAF,MAAM,CAACE,IAAI,CAAC,OAAO,CAAC;QACpB,IAAIV,GAAG,CAACW,YAAY,EAAE;UACpBH,MAAM,CAACE,IAAI,CAAC,WAAW,CAAC;QAC1B;QACAF,MAAM,CAACE,IAAI,CAAC,eAAe,CAAC;QAC5B,OAAOF,MAAM;MACf;IACF;EACF,CAAC;AAAA,CAAC;AAEK,IAAMI,mBAAmB,GAAG,SAAtBA,mBAAmBA,CAAA;EAAA,OAAU;IACxCC,eAAe,EAAE;MACff,IAAI,EAAE,gBAAgB;MACtBC,SAAS,EAAE,SAAAA,UAACC,GAAG,EAAK;QAClB,IAAMQ,MAAM,GAAG,CAAC,IAAAT,yBAAS,EAACC,GAAG,EAAEV,yBAAyB,CAAC,CAAC,CAAC,CAAC;QAC5D,IAAIU,GAAG,CAACc,KAAK,EAAE;UACbN,MAAM,CAACE,IAAI,CAAC,IAAAX,yBAAS,EAAC;YAACgB,cAAc,EAAEf;UAAG,CAAC,EAAEO,8BAA8B,CAAC,CAAC,CAAC,CAAC;QACjF;QACA,OAAOC,MAAM;MACf;IACF;EACF,CAAC;AAAA,CAAC;AAACQ,OAAA,CAAAJ,mBAAA,GAAAA,mBAAA"}