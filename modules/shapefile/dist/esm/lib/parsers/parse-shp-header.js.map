{"version":3,"file":"parse-shp-header.js","names":["LITTLE_ENDIAN","BIG_ENDIAN","SHP_MAGIC_NUMBER","parseSHPHeader","headerView","header","magic","getInt32","length","version","type","bbox","minX","getFloat64","minY","minZ","minM","maxX","maxY","maxZ","maxM","console","error","concat"],"sources":["../../../../src/lib/parsers/parse-shp-header.ts"],"sourcesContent":["export interface SHPHeader {\n  /** SHP Magic number */\n  magic: number;\n\n  /** Number of bytes in file */\n  length: number;\n  version: number;\n  type: number;\n  bbox: {\n    minX: number;\n    minY: number;\n    minZ: number;\n    minM: number;\n    maxX: number;\n    maxY: number;\n    maxZ: number;\n    maxM: number;\n  };\n}\n\nconst LITTLE_ENDIAN = true;\nconst BIG_ENDIAN = false;\nconst SHP_MAGIC_NUMBER = 0x0000270a;\n\n/**\n * Extract the binary header\n * Note: Also used by SHX\n * @param headerView\n * @returns SHPHeader\n */\nexport function parseSHPHeader(headerView: DataView): SHPHeader {\n  // Note: The SHP format switches endianness between fields!\n  // https://www.esri.com/library/whitepapers/pdfs/shapefile.pdf\n  const header = {\n    magic: headerView.getInt32(0, BIG_ENDIAN),\n    // Length is stored as # of 2-byte words; multiply by 2 to get # of bytes\n    length: headerView.getInt32(24, BIG_ENDIAN) * 2,\n    version: headerView.getInt32(28, LITTLE_ENDIAN),\n    type: headerView.getInt32(32, LITTLE_ENDIAN),\n    bbox: {\n      minX: headerView.getFloat64(36, LITTLE_ENDIAN),\n      minY: headerView.getFloat64(44, LITTLE_ENDIAN),\n      minZ: headerView.getFloat64(68, LITTLE_ENDIAN),\n      minM: headerView.getFloat64(84, LITTLE_ENDIAN),\n      maxX: headerView.getFloat64(52, LITTLE_ENDIAN),\n      maxY: headerView.getFloat64(60, LITTLE_ENDIAN),\n      maxZ: headerView.getFloat64(76, LITTLE_ENDIAN),\n      maxM: headerView.getFloat64(92, LITTLE_ENDIAN)\n    }\n  };\n  if (header.magic !== SHP_MAGIC_NUMBER) {\n    // eslint-disable-next-line\n    console.error(`SHP file: bad magic number ${header.magic}`);\n  }\n  if (header.version !== 1000) {\n    // eslint-disable-next-line\n    console.error(`SHP file: bad version ${header.version}`);\n  }\n  return header;\n}\n"],"mappings":"AAoBA,MAAMA,aAAa,GAAG,IAAI;AAC1B,MAAMC,UAAU,GAAG,KAAK;AACxB,MAAMC,gBAAgB,GAAG,UAAU;AAQnC,OAAO,SAASC,cAAcA,CAACC,UAAoB,EAAa;EAG9D,MAAMC,MAAM,GAAG;IACbC,KAAK,EAAEF,UAAU,CAACG,QAAQ,CAAC,CAAC,EAAEN,UAAU,CAAC;IAEzCO,MAAM,EAAEJ,UAAU,CAACG,QAAQ,CAAC,EAAE,EAAEN,UAAU,CAAC,GAAG,CAAC;IAC/CQ,OAAO,EAAEL,UAAU,CAACG,QAAQ,CAAC,EAAE,EAAEP,aAAa,CAAC;IAC/CU,IAAI,EAAEN,UAAU,CAACG,QAAQ,CAAC,EAAE,EAAEP,aAAa,CAAC;IAC5CW,IAAI,EAAE;MACJC,IAAI,EAAER,UAAU,CAACS,UAAU,CAAC,EAAE,EAAEb,aAAa,CAAC;MAC9Cc,IAAI,EAAEV,UAAU,CAACS,UAAU,CAAC,EAAE,EAAEb,aAAa,CAAC;MAC9Ce,IAAI,EAAEX,UAAU,CAACS,UAAU,CAAC,EAAE,EAAEb,aAAa,CAAC;MAC9CgB,IAAI,EAAEZ,UAAU,CAACS,UAAU,CAAC,EAAE,EAAEb,aAAa,CAAC;MAC9CiB,IAAI,EAAEb,UAAU,CAACS,UAAU,CAAC,EAAE,EAAEb,aAAa,CAAC;MAC9CkB,IAAI,EAAEd,UAAU,CAACS,UAAU,CAAC,EAAE,EAAEb,aAAa,CAAC;MAC9CmB,IAAI,EAAEf,UAAU,CAACS,UAAU,CAAC,EAAE,EAAEb,aAAa,CAAC;MAC9CoB,IAAI,EAAEhB,UAAU,CAACS,UAAU,CAAC,EAAE,EAAEb,aAAa;IAC/C;EACF,CAAC;EACD,IAAIK,MAAM,CAACC,KAAK,KAAKJ,gBAAgB,EAAE;IAErCmB,OAAO,CAACC,KAAK,+BAAAC,MAAA,CAA+BlB,MAAM,CAACC,KAAK,CAAE,CAAC;EAC7D;EACA,IAAID,MAAM,CAACI,OAAO,KAAK,IAAI,EAAE;IAE3BY,OAAO,CAACC,KAAK,0BAAAC,MAAA,CAA0BlB,MAAM,CAACI,OAAO,CAAE,CAAC;EAC1D;EACA,OAAOJ,MAAM;AACf"}