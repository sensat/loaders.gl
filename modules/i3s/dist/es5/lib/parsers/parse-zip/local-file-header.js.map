{"version":3,"file":"local-file-header.js","names":["parseZipLocalFileHeader","headerOffset","buffer","offsets","COMPRESSED_SIZE_OFFSET","FILE_NAME_LENGTH_OFFSET","EXTRA_FIELD_LENGTH_OFFSET","FILE_NAME_OFFSET","fileNameLength","getUint16","extraFieldLength","fileDataOffset","compressedSize","getUint32","exports"],"sources":["../../../../../src/lib/parsers/parse-zip/local-file-header.ts"],"sourcesContent":["/**\n * zip local file header info\n * according to https://en.wikipedia.org/wiki/ZIP_(file_format)\n */\nexport type ZipLocalFileHeader = {\n  /**\n   * File name length\n   */\n  fileNameLength: number;\n  /**\n   * Extra field length\n   */\n  extraFieldLength: number;\n  /**\n   * Offset of the file data\n   */\n  fileDataOffset: number;\n  /**\n   * Compressed size\n   */\n  compressedSize: number;\n};\n\n/**\n * Parses local file header of zip file\n * @param headerOffset - offset in the archive where header starts\n * @param buffer - buffer containing whole array\n * @returns Info from the header\n */\nexport const parseZipLocalFileHeader = (\n  headerOffset: number,\n  buffer: DataView\n): ZipLocalFileHeader => {\n  const offsets = {\n    COMPRESSED_SIZE_OFFSET: 18,\n    FILE_NAME_LENGTH_OFFSET: 26,\n    EXTRA_FIELD_LENGTH_OFFSET: 28,\n    FILE_NAME_OFFSET: 30\n  };\n\n  const fileNameLength = buffer.getUint16(headerOffset + offsets.FILE_NAME_LENGTH_OFFSET, true);\n\n  const extraFieldLength = buffer.getUint16(headerOffset + offsets.EXTRA_FIELD_LENGTH_OFFSET, true);\n\n  const fileDataOffset =\n    headerOffset + offsets.FILE_NAME_OFFSET + fileNameLength + extraFieldLength;\n\n  const compressedSize = buffer.getUint32(headerOffset + offsets.COMPRESSED_SIZE_OFFSET, true);\n\n  return {\n    fileNameLength,\n    extraFieldLength,\n    fileDataOffset,\n    compressedSize\n  };\n};\n"],"mappings":";;;;;;AA6BO,IAAMA,uBAAuB,GAAG,SAA1BA,uBAAuBA,CAClCC,YAAoB,EACpBC,MAAgB,EACO;EACvB,IAAMC,OAAO,GAAG;IACdC,sBAAsB,EAAE,EAAE;IAC1BC,uBAAuB,EAAE,EAAE;IAC3BC,yBAAyB,EAAE,EAAE;IAC7BC,gBAAgB,EAAE;EACpB,CAAC;EAED,IAAMC,cAAc,GAAGN,MAAM,CAACO,SAAS,CAACR,YAAY,GAAGE,OAAO,CAACE,uBAAuB,EAAE,IAAI,CAAC;EAE7F,IAAMK,gBAAgB,GAAGR,MAAM,CAACO,SAAS,CAACR,YAAY,GAAGE,OAAO,CAACG,yBAAyB,EAAE,IAAI,CAAC;EAEjG,IAAMK,cAAc,GAClBV,YAAY,GAAGE,OAAO,CAACI,gBAAgB,GAAGC,cAAc,GAAGE,gBAAgB;EAE7E,IAAME,cAAc,GAAGV,MAAM,CAACW,SAAS,CAACZ,YAAY,GAAGE,OAAO,CAACC,sBAAsB,EAAE,IAAI,CAAC;EAE5F,OAAO;IACLI,cAAc,EAAdA,cAAc;IACdE,gBAAgB,EAAhBA,gBAAgB;IAChBC,cAAc,EAAdA,cAAc;IACdC,cAAc,EAAdA;EACF,CAAC;AACH,CAAC;AAACE,OAAA,CAAAd,uBAAA,GAAAA,uBAAA"}