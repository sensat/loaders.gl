{"version":3,"file":"arrow-like-table.js","names":["ArrowLikeSchema","deduceTableSchema","getTableCell","getTableLength","getTableNumCols","ArrowLikeVector","constructor","table","columnName","_defineProperty","get","rowIndex","toArray","_this$table$data$getC","shape","data","getChild","Error","ArrowLikeTable","schema","fields","metadata","numCols","length"],"sources":["../../../../../src/lib/table/arrow-api/arrow-like-table.ts"],"sourcesContent":["// loaders.gl, MIT license\n\nimport {Table} from '../../../types/category-table';\n\nimport {ArrowLikeSchema} from './arrow-like-schema';\n\nimport {deduceTableSchema} from '../simple-table/table-schema';\n\nimport {\n  getTableCell,\n  getTableLength,\n  getTableNumCols\n  // getTableCell,\n  // getTableRowShape,\n  // getTableColumnIndex,\n  // getTableColumnName,\n  // getTableRowAsObject,\n  // getTableRowAsArray\n} from '../simple-table/table-accessors';\n\nclass ArrowLikeVector {\n  table: Table;\n  columnName: string;\n\n  constructor(table: Table, columnName: string) {\n    this.table = table;\n    this.columnName = columnName;\n  }\n\n  get(rowIndex: number): unknown {\n    return getTableCell(this.table, rowIndex, this.columnName);\n  }\n\n  toArray(): ArrayLike<unknown> {\n    switch (this.table.shape) {\n      case 'arrow-table':\n        return this.table.data.getChild(this.columnName)?.toArray();\n      case 'columnar-table':\n        return this.table.data[this.columnName];\n      default:\n        throw new Error(this.table.shape);\n    }\n  }\n}\n\n/**\n * Class that provides an API similar to Apache Arrow Table class\n * Forwards methods directly if the underlying table is Arrow, otherwise calls accessor functions\n */\nexport class ArrowLikeTable {\n  schema: ArrowLikeSchema;\n  table: Table;\n\n  constructor(table: Table) {\n    const schema = table.schema || deduceTableSchema(table);\n    this.schema = new ArrowLikeSchema(schema.fields, schema.metadata);\n    this.table = {...table, schema};\n  }\n\n  // get schema() {\n  //   return this.table.schema;\n  // }\n\n  get data() {\n    return this.table.data;\n  }\n\n  get numCols(): number {\n    return getTableNumCols(this.table);\n  }\n\n  get length(): number {\n    return getTableLength(this.table);\n  }\n\n  getChild(columnName: string): ArrowLikeVector {\n    return new ArrowLikeVector(this.table, columnName);\n  }\n\n  // getChildAt(columnIndex: number): ArrowLikeVector {\n  //   return\n  // }\n}\n"],"mappings":";AAIA,SAAQA,eAAe,QAAO,qBAAqB;AAEnD,SAAQC,iBAAiB,QAAO,8BAA8B;AAE9D,SACEC,YAAY,EACZC,cAAc,EACdC,eAAe,QAOV,iCAAiC;AAExC,MAAMC,eAAe,CAAC;EAIpBC,WAAWA,CAACC,KAAY,EAAEC,UAAkB,EAAE;IAAAC,eAAA;IAAAA,eAAA;IAC5C,IAAI,CAACF,KAAK,GAAGA,KAAK;IAClB,IAAI,CAACC,UAAU,GAAGA,UAAU;EAC9B;EAEAE,GAAGA,CAACC,QAAgB,EAAW;IAC7B,OAAOT,YAAY,CAAC,IAAI,CAACK,KAAK,EAAEI,QAAQ,EAAE,IAAI,CAACH,UAAU,CAAC;EAC5D;EAEAI,OAAOA,CAAA,EAAuB;IAAA,IAAAC,qBAAA;IAC5B,QAAQ,IAAI,CAACN,KAAK,CAACO,KAAK;MACtB,KAAK,aAAa;QAChB,QAAAD,qBAAA,GAAO,IAAI,CAACN,KAAK,CAACQ,IAAI,CAACC,QAAQ,CAAC,IAAI,CAACR,UAAU,CAAC,cAAAK,qBAAA,uBAAzCA,qBAAA,CAA2CD,OAAO,CAAC,CAAC;MAC7D,KAAK,gBAAgB;QACnB,OAAO,IAAI,CAACL,KAAK,CAACQ,IAAI,CAAC,IAAI,CAACP,UAAU,CAAC;MACzC;QACE,MAAM,IAAIS,KAAK,CAAC,IAAI,CAACV,KAAK,CAACO,KAAK,CAAC;IACrC;EACF;AACF;AAMA,OAAO,MAAMI,cAAc,CAAC;EAI1BZ,WAAWA,CAACC,KAAY,EAAE;IAAAE,eAAA;IAAAA,eAAA;IACxB,MAAMU,MAAM,GAAGZ,KAAK,CAACY,MAAM,IAAIlB,iBAAiB,CAACM,KAAK,CAAC;IACvD,IAAI,CAACY,MAAM,GAAG,IAAInB,eAAe,CAACmB,MAAM,CAACC,MAAM,EAAED,MAAM,CAACE,QAAQ,CAAC;IACjE,IAAI,CAACd,KAAK,GAAG;MAAC,GAAGA,KAAK;MAAEY;IAAM,CAAC;EACjC;EAMA,IAAIJ,IAAIA,CAAA,EAAG;IACT,OAAO,IAAI,CAACR,KAAK,CAACQ,IAAI;EACxB;EAEA,IAAIO,OAAOA,CAAA,EAAW;IACpB,OAAOlB,eAAe,CAAC,IAAI,CAACG,KAAK,CAAC;EACpC;EAEA,IAAIgB,MAAMA,CAAA,EAAW;IACnB,OAAOpB,cAAc,CAAC,IAAI,CAACI,KAAK,CAAC;EACnC;EAEAS,QAAQA,CAACR,UAAkB,EAAmB;IAC5C,OAAO,IAAIH,eAAe,CAAC,IAAI,CAACE,KAAK,EAAEC,UAAU,CAAC;EACpD;AAKF"}