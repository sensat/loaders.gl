{"version":3,"file":"arrow-like-table.js","names":["_arrowLikeSchema","require","_tableSchema","_tableAccessors","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty2","default","getOwnPropertyDescriptors","defineProperties","defineProperty","ArrowLikeVector","table","columnName","_classCallCheck2","_createClass2","value","get","rowIndex","getTableCell","toArray","_this$table$data$getC","shape","data","getChild","Error","ArrowLikeTable","schema","deduceTableSchema","ArrowLikeSchema","fields","metadata","getTableNumCols","getTableLength","exports"],"sources":["../../../../../src/lib/table/arrow-api/arrow-like-table.ts"],"sourcesContent":["// loaders.gl, MIT license\n\nimport {Table} from '../../../types/category-table';\n\nimport {ArrowLikeSchema} from './arrow-like-schema';\n\nimport {deduceTableSchema} from '../simple-table/table-schema';\n\nimport {\n  getTableCell,\n  getTableLength,\n  getTableNumCols\n  // getTableCell,\n  // getTableRowShape,\n  // getTableColumnIndex,\n  // getTableColumnName,\n  // getTableRowAsObject,\n  // getTableRowAsArray\n} from '../simple-table/table-accessors';\n\nclass ArrowLikeVector {\n  table: Table;\n  columnName: string;\n\n  constructor(table: Table, columnName: string) {\n    this.table = table;\n    this.columnName = columnName;\n  }\n\n  get(rowIndex: number): unknown {\n    return getTableCell(this.table, rowIndex, this.columnName);\n  }\n\n  toArray(): ArrayLike<unknown> {\n    switch (this.table.shape) {\n      case 'arrow-table':\n        return this.table.data.getChild(this.columnName)?.toArray();\n      case 'columnar-table':\n        return this.table.data[this.columnName];\n      default:\n        throw new Error(this.table.shape);\n    }\n  }\n}\n\n/**\n * Class that provides an API similar to Apache Arrow Table class\n * Forwards methods directly if the underlying table is Arrow, otherwise calls accessor functions\n */\nexport class ArrowLikeTable {\n  schema: ArrowLikeSchema;\n  table: Table;\n\n  constructor(table: Table) {\n    const schema = table.schema || deduceTableSchema(table);\n    this.schema = new ArrowLikeSchema(schema.fields, schema.metadata);\n    this.table = {...table, schema};\n  }\n\n  // get schema() {\n  //   return this.table.schema;\n  // }\n\n  get data() {\n    return this.table.data;\n  }\n\n  get numCols(): number {\n    return getTableNumCols(this.table);\n  }\n\n  get length(): number {\n    return getTableLength(this.table);\n  }\n\n  getChild(columnName: string): ArrowLikeVector {\n    return new ArrowLikeVector(this.table, columnName);\n  }\n\n  // getChildAt(columnIndex: number): ArrowLikeVector {\n  //   return\n  // }\n}\n"],"mappings":"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"}