{"version":3,"file":"get-las-schema.js","names":["deduceMeshSchema","getLASSchema","lasHeader","attributes","metadataMap","makeMetadataFromLasHeader","schema","metadata","las_pointsOffset","pointsOffset","toString","las_pointsFormatId","pointsFormatId","las_pointsStructSize","pointsStructSize","las_pointsCount","pointsCount","las_scale","JSON","stringify","scale","las_offset","offset","maxs","undefined","las_maxs","mins","las_mins","las_totalToRead","totalToRead","las_pointsFortotalReadmatId","totalRead","versionAsString","las_versionAsString","isCompressed","las_isCompressed"],"sources":["../../../src/lib/get-las-schema.ts"],"sourcesContent":["import {Schema, MeshAttributes, deduceMeshSchema} from '@loaders.gl/schema';\nimport type {LASHeader} from './las-types';\n\n/**\n * Gets schema from PLY header\n * @param lasHeader\n * @param metadata\n * @returns Schema\n */\nexport function getLASSchema(lasHeader: LASHeader, attributes: MeshAttributes): Schema {\n  const metadataMap = makeMetadataFromLasHeader(lasHeader);\n  const schema = deduceMeshSchema(attributes, metadataMap);\n  return schema;\n}\n\n/**\n * Make arrow like schema metadata by LASHeader properties\n * @param lasHeader\n * @returns\n */\nexport function makeMetadataFromLasHeader(lasHeader: LASHeader): Record<string, string> {\n  const metadata: Record<string, string> = {};\n  /* eslint-disable camelcase */\n  metadata.las_pointsOffset = lasHeader.pointsOffset.toString(10);\n  metadata.las_pointsFormatId = lasHeader.pointsFormatId.toString(10);\n  metadata.las_pointsStructSize = lasHeader.pointsStructSize.toString(10);\n  metadata.las_pointsCount = lasHeader.pointsCount.toString(10);\n  metadata.las_scale = JSON.stringify(lasHeader.scale);\n  metadata.las_offset = JSON.stringify(lasHeader.offset);\n  if (lasHeader.maxs !== undefined) {\n    metadata.las_maxs = JSON.stringify(lasHeader.maxs);\n  }\n  if (lasHeader.mins !== undefined) {\n    metadata.las_mins = JSON.stringify(lasHeader.mins);\n  }\n  metadata.las_totalToRead = lasHeader.totalToRead.toString(10);\n  metadata.las_pointsFortotalReadmatId = lasHeader.totalRead.toString(10);\n  if (lasHeader.versionAsString !== undefined) {\n    metadata.las_versionAsString = lasHeader.versionAsString;\n  }\n  if (lasHeader.isCompressed !== undefined) {\n    metadata.las_isCompressed = lasHeader.isCompressed.toString();\n  }\n  return metadata;\n}\n"],"mappings":"AAAA,SAAgCA,gBAAgB,QAAO,oBAAoB;AAS3E,OAAO,SAASC,YAAYA,CAACC,SAAoB,EAAEC,UAA0B,EAAU;EACrF,MAAMC,WAAW,GAAGC,yBAAyB,CAACH,SAAS,CAAC;EACxD,MAAMI,MAAM,GAAGN,gBAAgB,CAACG,UAAU,EAAEC,WAAW,CAAC;EACxD,OAAOE,MAAM;AACf;AAOA,OAAO,SAASD,yBAAyBA,CAACH,SAAoB,EAA0B;EACtF,MAAMK,QAAgC,GAAG,CAAC,CAAC;EAE3CA,QAAQ,CAACC,gBAAgB,GAAGN,SAAS,CAACO,YAAY,CAACC,QAAQ,CAAC,EAAE,CAAC;EAC/DH,QAAQ,CAACI,kBAAkB,GAAGT,SAAS,CAACU,cAAc,CAACF,QAAQ,CAAC,EAAE,CAAC;EACnEH,QAAQ,CAACM,oBAAoB,GAAGX,SAAS,CAACY,gBAAgB,CAACJ,QAAQ,CAAC,EAAE,CAAC;EACvEH,QAAQ,CAACQ,eAAe,GAAGb,SAAS,CAACc,WAAW,CAACN,QAAQ,CAAC,EAAE,CAAC;EAC7DH,QAAQ,CAACU,SAAS,GAAGC,IAAI,CAACC,SAAS,CAACjB,SAAS,CAACkB,KAAK,CAAC;EACpDb,QAAQ,CAACc,UAAU,GAAGH,IAAI,CAACC,SAAS,CAACjB,SAAS,CAACoB,MAAM,CAAC;EACtD,IAAIpB,SAAS,CAACqB,IAAI,KAAKC,SAAS,EAAE;IAChCjB,QAAQ,CAACkB,QAAQ,GAAGP,IAAI,CAACC,SAAS,CAACjB,SAAS,CAACqB,IAAI,CAAC;EACpD;EACA,IAAIrB,SAAS,CAACwB,IAAI,KAAKF,SAAS,EAAE;IAChCjB,QAAQ,CAACoB,QAAQ,GAAGT,IAAI,CAACC,SAAS,CAACjB,SAAS,CAACwB,IAAI,CAAC;EACpD;EACAnB,QAAQ,CAACqB,eAAe,GAAG1B,SAAS,CAAC2B,WAAW,CAACnB,QAAQ,CAAC,EAAE,CAAC;EAC7DH,QAAQ,CAACuB,2BAA2B,GAAG5B,SAAS,CAAC6B,SAAS,CAACrB,QAAQ,CAAC,EAAE,CAAC;EACvE,IAAIR,SAAS,CAAC8B,eAAe,KAAKR,SAAS,EAAE;IAC3CjB,QAAQ,CAAC0B,mBAAmB,GAAG/B,SAAS,CAAC8B,eAAe;EAC1D;EACA,IAAI9B,SAAS,CAACgC,YAAY,KAAKV,SAAS,EAAE;IACxCjB,QAAQ,CAAC4B,gBAAgB,GAAGjC,SAAS,CAACgC,YAAY,CAACxB,QAAQ,CAAC,CAAC;EAC/D;EACA,OAAOH,QAAQ;AACjB"}