{"version":3,"file":"parse-json.js","names":["_schema","require","parseJSONSync","jsonText","options","_options$json","json","JSON","parse","table","data","getFirstArray","makeTableFromData","error","Error","Array","isArray","_typeof2","default","_i","_Object$values","Object","values","length","value","array"],"sources":["../../../../src/lib/parsers/parse-json.ts"],"sourcesContent":["// loaders.gl, MIT license\nimport type {RowTable} from '@loaders.gl/schema';\nimport {makeTableFromData} from '@loaders.gl/schema';\nimport type {JSONLoaderOptions} from '../../json-loader';\n\nexport function parseJSONSync(jsonText: string, options: JSONLoaderOptions): RowTable {\n  try {\n    const json = JSON.parse(jsonText);\n    if (options.json?.table) {\n      const data = getFirstArray(json) || json;\n      return makeTableFromData(data);\n    }\n    return json;\n  } catch (error) {\n    throw new Error('JSONLoader: failed to parse JSON');\n  }\n}\n\nfunction getFirstArray(json) {\n  if (Array.isArray(json)) {\n    return json;\n  }\n  if (json && typeof json === 'object') {\n    for (const value of Object.values(json)) {\n      const array = getFirstArray(value);\n      if (array) {\n        return array;\n      }\n    }\n  }\n  return null;\n}\n"],"mappings":";;;;;;;;AAEA,IAAAA,OAAA,GAAAC,OAAA;AAGO,SAASC,aAAaA,CAACC,QAAgB,EAAEC,OAA0B,EAAY;EACpF,IAAI;IAAA,IAAAC,aAAA;IACF,IAAMC,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACL,QAAQ,CAAC;IACjC,KAAAE,aAAA,GAAID,OAAO,CAACE,IAAI,cAAAD,aAAA,eAAZA,aAAA,CAAcI,KAAK,EAAE;MACvB,IAAMC,IAAI,GAAGC,aAAa,CAACL,IAAI,CAAC,IAAIA,IAAI;MACxC,OAAO,IAAAM,yBAAiB,EAACF,IAAI,CAAC;IAChC;IACA,OAAOJ,IAAI;EACb,CAAC,CAAC,OAAOO,KAAK,EAAE;IACd,MAAM,IAAIC,KAAK,CAAC,kCAAkC,CAAC;EACrD;AACF;AAEA,SAASH,aAAaA,CAACL,IAAI,EAAE;EAC3B,IAAIS,KAAK,CAACC,OAAO,CAACV,IAAI,CAAC,EAAE;IACvB,OAAOA,IAAI;EACb;EACA,IAAIA,IAAI,IAAI,IAAAW,QAAA,CAAAC,OAAA,EAAOZ,IAAI,MAAK,QAAQ,EAAE;IACpC,SAAAa,EAAA,MAAAC,cAAA,GAAoBC,MAAM,CAACC,MAAM,CAAChB,IAAI,CAAC,EAAAa,EAAA,GAAAC,cAAA,CAAAG,MAAA,EAAAJ,EAAA,IAAE;MAApC,IAAMK,KAAK,GAAAJ,cAAA,CAAAD,EAAA;MACd,IAAMM,KAAK,GAAGd,aAAa,CAACa,KAAK,CAAC;MAClC,IAAIC,KAAK,EAAE;QACT,OAAOA,KAAK;MACd;IACF;EACF;EACA,OAAO,IAAI;AACb"}